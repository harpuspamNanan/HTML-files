angular.module("vtcApp",["ngRoute","ngAnimate","ui.bootstrap","ngProgress","ngMessages","ui.sortable","ui.codemirror"]).factory("contentCache",["$cacheFactory",function($cacheFactory){return $cacheFactory("requestUrl")}]).factory("helperFunctions",["$uibModal","$timeout","ngProgressFactory",function($uibModal,$timeout,ngProgressFactory){var progressbar=ngProgressFactory.createInstance();var showAlertMessage=function(type,message,callBack){var template;if(type==="success")template="/static/templates/modals/success.html";
else template="/static/templates/modals/error.html";var modalInstance=$uibModal.open({templateUrl:template,controller:"ModalInstanceCtrl",animation:false,backdrop:false,resolve:{data:function(){return{"call_back":callBack,"message":message}}}});modalInstance.result.then(function(call_back){call_back()},function(){})};var alertMsg=function(msg){alert("Helper: "+msg)};var showNotification=function(type,message){var template,tag;if(type==="success"){template="/static/templates/notifications/success.html";
tag="success_notification"}else{template="/static/templates/notifications/error.html";tag="error_notification"}var content="<div>"+message+"</div>";$("#"+tag).show().html(content).slideDown(1E3);var delay=6E3;$timeout(function(){$("#"+tag).slideUp(1E3)},delay)};return{showAlertMessage:showAlertMessage,alertMsg:alertMsg,showNotification:showNotification,progressbar:progressbar}}]).controller("mainController",["$scope","$rootScope","$compile","$uibModal","$window",function($scope,$rootScope,$compile,
$uibModal,$window){$rootScope.windowWidth=$window.innerWidth;angular.element($window).bind("resize",function(){$rootScope.windowWidth=$window.innerWidth;$rootScope.$digest()})}]).controller("ModalInstanceCtrl",["$scope","$uibModalInstance","data",function($scope,$uibModalInstance,data){$scope.call_back=data.call_back;$scope.message=data.message;$scope.ok=function(){$uibModalInstance.close($scope.call_back)};$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}]).run(["$rootScope","$location",
"$timeout","$http","$window",function($rootScope,$location,$timeout,$http,$window){$http.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";$rootScope.$watch(function(){return $location.path()},function(a){$window.dataLayer.push({"event":"VirtualPageview","virtualPageUrl":$location.url(),"virtualPageTitle":"Virtual Page View with URL: "+$location.url()});$timeout.cancel($rootScope.stopped);if(a&&a!=="/forum"&&a!=="/content"&&a!=="/project"&&a!=="/admin_final_test"&&a!=="/questions"&&a!==
"/project_evaluation")$timeout(function(){if(localStorage.getItem("currentUrl")){var currentUrl="/"+localStorage.getItem($rootScope.currentCourseUrl+"currentUrl");if(currentUrl!==a)$rootScope.customContentRoute()}},500)})}]);$(document).ready(function(){var footer_height=$("#footer").outerHeight();$("#content").css("padding-bottom",footer_height);var window_height=window.innerHeight;$("#wrapper").css("min-height",window_height)});var vtcApp=angular.module("vtcApp").controller("contentController",["$scope","$rootScope","$compile","$http","$sce","$location","contentCache","$timeout","$log","ngProgressFactory","$window","helperFunctions",function($scope,$rootScope,$compile,$http,$sce,$location,contentCache,$timeout,$log,ngProgressFactory,$window,helperFunctions){$rootScope.currentModuleName="";$rootScope.currentTopicName="";$rootScope.currentModuleId;$rootScope.currentTopicId;$rootScope.currentScreenId;$rootScope.currentScreenType;
$rootScope.nextModuleId;$rootScope.nextTopicId;$rootScope.nextScreenId;$rootScope.nextScreenType;$rootScope.prevModuleId;$rootScope.prevTopicId;$rootScope.prevScreenId;$rootScope.prevScreenType;$rootScope.currentQuizQuestionNumberToDisplay;$rootScope.currentQuizQuestionNumber;$rootScope.currentScreenContent;$rootScope.currentScreenData;$rootScope.quizQuestions;$rootScope.isQuizQuestionAnswered=false;$rootScope.isCorrectAnswer=false;$rootScope.performSubmitButtonAction=false;$rootScope.menu;$rootScope.projectDescription;
$rootScope.screensNavigationData;$rootScope.firstScreenData;$rootScope.lastScreenData;$rootScope.currentTopicData;$rootScope.currentTopicScreensData;$rootScope.isTestScreenActive=false;$rootScope.isModuleTestSummaryScreenActive=false;$rootScope.isFinalTestSummaryScreenActive=false;$rootScope.isFinalTestScreenActive=false;$rootScope.showScreenNavigation=true;$rootScope.isForumLoaded=false;$rootScope.isCourseMenuLoaded=false;$rootScope.currentPage="";$rootScope.currentModuleTestQuestion;$rootScope.currentFinalTestQuestion;
$rootScope.userLastScreenData=[];$rootScope.nameToDisplayOnCodeChallengeResetClearButton="Reset Code";$rootScope.moduleExist=false;$rootScope.baseUrl="https://training.internshala.com/";if($rootScope.windowWidth<=768){$("#dropdownMenu1").removeClass("dropdown-toggle");$("#dropdownMenu1").addClass("toggle_sidebar")}else{$("#dropdownMenu1").addClass("dropdown-toggle");$("#dropdownMenu1").removeClass("toggle_sidebar")}$rootScope.progressbar=ngProgressFactory.createInstance();$scope.addActiveClass=function(element){$(".menu_heading_container").removeClass("active");
$("#"+element).addClass("active")};$rootScope.getCourseMenu=function(){$http.get("/content/menu/"+$rootScope.currentCourseUrl).success(function(data){$rootScope.menu=data.menu;$rootScope.projectDescription=data.project_description;$rootScope.isFinalTestLocked=data.is_final_test_locked;$("#course_menu").html($compile('<course-menu data="menu"></course-menu>')($scope));$rootScope.isCourseMenuLoaded=true;$rootScope.getScreensOrder()})};$rootScope.getScreensOrder=function(){$http.get("/content/screens_order/"+
$rootScope.currentCourseUrl).success(function(data){$rootScope.screensNavigationData=data.screens_data.screens;$rootScope.firstScreenData=data.screens_data.first_screen;$rootScope.lastScreenData=data.screens_data.last_screen;$rootScope.customContentRoute()})};$rootScope.changeRootScopesAndHighlightActiveElements=function(){$rootScope.currentModuleId=null;$rootScope.currentTopicId=null};$rootScope.customContentRoute=function(){$rootScope.tryYourselfUrl="/try_yourself/"+$rootScope.currentCourseUrl;
var baseUrl=$location.$$absUrl.split("#");if(baseUrl.length===1){$rootScope.initializeOverview();return}var contentUrl=$location.$$absUrl.split("#")[1].split("/");switch(contentUrl[1]){case "topic":$rootScope.initializeTopic(contentUrl[2],"next",false,false);break;case "module_test":$rootScope.currentModuleId=contentUrl[2];$rootScope.initializeModuleTest($rootScope.currentModuleId);break;case "final_test":$rootScope.initializeFinalTest();break;case "overview":$rootScope.initializeOverview();break;
case "progress_tracker":$rootScope.initializeProgressTracker();break;default:helperFunctions.showAlertMessage("error","Invalid Url",function(){$rootScope.redirectToLastVisitedScreen()});return;break}if(contentUrl[1]==="topic"||contentUrl[1]==="module_test"||contentUrl[1]==="final_test")$scope.addActiveClass("study_room_container")};$rootScope.initializeStudyRoom=function(){if($("#study_room_container").hasClass("active"))return;$scope.addActiveClass("study_room_container");$rootScope.progressbar.start();
$http.get("/content/user_last_screen/"+$rootScope.currentCourseUrl).success(function(data){if(data.success){$rootScope.userLastScreenData=data.last_screen_data;$rootScope.initializeTopic($rootScope.userLastScreenData[0].topic_id,"last_visited",true,true)}else $rootScope.initializeTopic($rootScope.firstScreenData.topic_id,"next",true,true)})};$rootScope.setCurrentUrlInLocalStorage=function(url){localStorage.setItem($rootScope.currentCourseUrl+"currentUrl",url)};$rootScope.initializeOverview=function(){$rootScope.currentPage=
"overview";$rootScope.isFinalTestScreenActive=false;$scope.addActiveClass("overview_container");$rootScope.onLoadingScreen=true;$rootScope.progressbar.start();if($rootScope.windowWidth<768)$("#main_menu").slideUp();$("#topic_screen_navigation_container").hide();$rootScope.setCurrentUrlInLocalStorage("overview/");$location.path("overview/");$("#screen").html($compile('<div id="overview"><overview></overview></div>')($scope))};$rootScope.initializeDashboard=function(){window.location=$rootScope.baseUrl+
"dashboard"};$rootScope.initializeLogout=function(){window.location=$rootScope.baseUrl+"logout"};$rootScope.initializeProgressTracker=function(){$rootScope.currentPage="progress_tracker";$rootScope.isFinalTestScreenActive=false;$scope.addActiveClass("progress_tracker_container");$rootScope.onLoadingScreen=true;$rootScope.progressbar.start();if($rootScope.windowWidth<768)$("#main_menu").slideUp();$("#topic_screen_navigation_container").hide();$rootScope.setCurrentUrlInLocalStorage("progress_tracker/");
$location.path("progress_tracker/");$("#screen").html($compile('<div id="progress_tracker"><progress-tracker></progress-tracker></div>')($scope))};$rootScope.initializeTryYourSelf=function(){$("#try_yourself_code").val("");$("#try_yourself_compiler").val("");$("#submit_try_yourself_dock").click()};$rootScope.initializeModuleTest=function(moduleTestId){$rootScope.currentPage="study_room";$rootScope.onLoadingScreen=true;$rootScope.progressbar.start();$rootScope.currentModuleId=moduleTestId;if(!$("#study_room_container").hasClass("active"))$scope.addActiveClass("study_room_container");
if($rootScope.windowWidth<768)$("#main_menu").slideUp();$.each($rootScope.screensNavigationData,function(key,value){if(value.module_id==$rootScope.currentModuleId){$rootScope.moduleExist=true;$rootScope.currentTopicId=value.topic_id;$rootScope.currentScreenId=value.screen_id;$rootScope.currentModuleName=value.module_name;$rootScope.prevTopicId=value.topic_id;$rootScope.prevModuleId=value.module_id;$rootScope.prevScreenId=value.screen_id;if(value.topic_id!=$rootScope.lastScreenData.topic_id){$rootScope.nextTopicId=
$rootScope.screensNavigationData[key+1].topic_id;$rootScope.nextModuleId=$rootScope.screensNavigationData[key+1].module_id;$rootScope.nextScreenId=$rootScope.screensNavigationData[key+1].screen_id}else{$rootScope.showModuleTest();return}if(value.module_id!=$rootScope.nextModuleId){$rootScope.showModuleTest();return}return}});if(!$rootScope.moduleExist)helperFunctions.showAlertMessage("error","Module test does not exist. For any issues/ queries, please write to us at trainings@internshala.com.",function(){$rootScope.redirectToLastVisitedScreen()})};
$rootScope.initializeFinalTest=function(){$rootScope.currentPage="study_room";$rootScope.onLoadingScreen=true;$rootScope.progressbar.start();if($rootScope.windowWidth<768)$("#main_menu").slideUp();$(".module_test").removeClass("activetopic");if(!$(".menu_heading_container").hasClass("active"))$scope.addActiveClass("study_room_container");$rootScope.showFinalTest()};$rootScope.initializeTopic=function(topicId,navigatedFrom,isClick,isRedirected){if(topicId==$rootScope.currentTopicId&&isClick&&!isRedirected&&
!$rootScope.isTestScreenActive&&$("#study_room_container").hasClass("active"))return;if(topicId===null)$rootScope.initializeStudyRoom();$rootScope.onLoadingScreen=true;$rootScope.progressbar.start();$rootScope.isTestScreenActive=false;$rootScope.currentPage="study_room";$rootScope.setCurrentUrlInLocalStorage("topic/"+topicId);isClick?$location.path("topic/"+topicId):"";if(!$("#study_room_container").hasClass("active"))$scope.addActiveClass("study_room_container");$("#topic_"+$rootScope.currentTopicId).removeClass("activetopic");
$(".module_test").removeClass("activetopic");$("#topic_"+topicId).addClass("activetopic");$("#prev").show();if(isClick)$("#course_menu").animate({scrollTop:$("#topic_"+topicId).offset().top-$("#course_menu").offset().top+$("#course_menu").scrollTop()});if($rootScope.windowWidth<768)$("#main_menu").slideUp();$("#topic_screen_navigation_container").show();$("#icon_navigation_container").html("");var requestUrl="/content/topic/"+$rootScope.currentCourseUrl+"/"+topicId;if(contentCache.get(requestUrl)){var cachedContent=
contentCache.get(requestUrl);$timeout(function(){$rootScope.initializeTopicSuccess(cachedContent,navigatedFrom)},1E3)}else if(localStorage.getItem(requestUrl)&&false){var cachedContent=JSON.parse(localStorage.getItem(requestUrl));$timeout(function(){$rootScope.initializeTopicSuccess(cachedContent,navigatedFrom)},1E3)}else $http.get(requestUrl).success(function(data){contentCache.put(requestUrl,data);$rootScope.initializeTopicSuccess(data,navigatedFrom)});return};$rootScope.initializeTopicSuccess=
function(data,navigatedFrom){if(data.success){$rootScope.currentTopicData=data.topic_data.topic[0];$rootScope.currentTopicName=$rootScope.currentTopicData.name;$rootScope.currentModuleName=$rootScope.currentTopicData.module_name;$rootScope.currentTopicId=$rootScope.currentTopicData.id;$rootScope.currentModuleId=$rootScope.currentTopicData.module_id;$rootScope.isForumLoaded=false;if($rootScope.currentTopicData.screens!==null){$rootScope.currentTopicScreensData=$rootScope.currentTopicData.screens;$rootScope.initializeIconNavigationPanel();
switch(navigatedFrom){case "next":$rootScope.currentScreenType=$rootScope.currentTopicScreensData[0].type;$rootScope.currentScreenId=$rootScope.currentTopicScreensData[0].id;break;case "prev":$rootScope.currentScreenType=$rootScope.currentTopicScreensData[$rootScope.currentTopicScreensData.length-1].type;$rootScope.currentScreenId=$rootScope.currentTopicScreensData[$rootScope.currentTopicScreensData.length-1].id;break;case "last_visited":$rootScope.currentScreenType=$rootScope.userLastScreenData[0].screen_type;
$rootScope.currentScreenId=$rootScope.userLastScreenData[0].screen_id;break}$rootScope.initializeScreen($rootScope.currentScreenId,navigatedFrom,false)}else{$("#screen").html($compile('<p style="padding:15px;">Sorry no screens available for this topic. Please continue to the next topic. For any issues/ queries, please write to us at trainings@internshala.com.</p>')($scope));$rootScope.onLoadingScreen=false;$rootScope.progressbar.complete();$timeout(function(){$rootScope.enableNextButton()},100);$rootScope.currentScreenType=
null;$rootScope.currentScreenId=null;$rootScope.isModuleTestSummaryScreenActive=false;$rootScope.isFinalTestSummaryScreenActive=false;$rootScope.isFinalTestScreenActive=false;$("#topic_screen_navigation_container").show();$rootScope.isTestScreenActive=false;$("#next").show();return}}else if(data.topic_data!==null&&data.topic_data.topic_status==="locked")helperFunctions.showAlertMessage("error","Topic is locked",function(){if($rootScope.prevTopicId==$rootScope.currentTopicId){$rootScope.redirectToLastVisitedScreen();
return}else{if($rootScope.prevTopicId!=null)$rootScope.initializeTopic($rootScope.prevTopicId,"prev",true,true);else if($rootScope.currentTopicId!=null)$rootScope.initializeTopic($rootScope.currentTopicId,"prev",true,true);else $rootScope.redirectToLastVisitedScreen();return}});else helperFunctions.showAlertMessage("error",data.errorMessage,function(){$rootScope.redirectToLastVisitedScreen()});return};$rootScope.initializeIconNavigationPanel=function(){$timeout(function(){$("#icon_navigation_container").html($compile("<icon-navigation-menu></icon-navigation-menu>")($scope))},
100)};$rootScope.initializeScreen=function(screenId,navigatedFrom,isClick){if($rootScope.currentScreenId==screenId&&isClick)return;$rootScope.currentScreenId=screenId;if($rootScope.currentScreenId==$rootScope.firstScreenData.screen_id)$("#prev").hide();else $("#prev").show();$.each($rootScope.currentTopicScreensData,function(key,screen){if(screen.id==$rootScope.currentScreenId){$rootScope.currentScreenContent=screen.content;$rootScope.currentScreenData=screen;$rootScope.currentScreenType=screen.type;
$rootScope.helperTextContent=screen.helpertext_content;if($rootScope.isCourseMenuLoaded);switch(screen.type){case "video":$rootScope.initializeVideoScreen();break;case "html":$rootScope.initializeHtmlScreen();break;case "quiz":$rootScope.initializeQuizScreen(navigatedFrom);break;case "code_challenge":$rootScope.initializeCodeChallengeScreen();break}if($rootScope.helperTextContent!==null);$("#screen_helpers").html($compile("<screen-helpers></screen-helpers>")($scope));$("body").animate({scrollTop:0});
if(screen.status!=="viewed")$rootScope.updateUserScreenStatus(key);$(".icon").removeClass("active_video_screen_icon");$(".icon").removeClass("active_quiz_screen_icon");$(".icon").removeClass("active_code_challenge_screen_icon");$(".icon").removeClass("active_html_screen_icon");$timeout(function(){$("#screen_icon_"+screen.id).addClass("active_"+screen.type+"_screen_icon")},100);if(screen.type==="quiz")$rootScope.changeNextToSubmitAndDisableSubmit();else if(screen.type==="code_challenge")$rootScope.disableNextButton();
else $rootScope.enableNextButton();$rootScope.isModuleTestSummaryScreenActive=false;$rootScope.isFinalTestSummaryScreenActive=false;$rootScope.isFinalTestScreenActive=false;$rootScope.isTestScreenActive=false;$("#topic_screen_navigation_container").show();$("#next").show();$rootScope.updateCurrentScreenDataInLocalStorage();$rootScope.onLoadingScreen=false;$rootScope.progressbar.complete()}})};$rootScope.updateCurrentScreenDataInLocalStorage=function(){$scope.cureentScreendata={"screen_id":$rootScope.currentScreenId,
"screen_type":$rootScope.currentScreenType,"topic_id":$rootScope.currentTopicId,"module_id":$rootScope.currentModuleId};localStorage.setItem($rootScope.currentCourseUrl+"currentScreenData",JSON.stringify($scope.cureentScreendata))};$rootScope.redirectToLastVisitedScreen=function(){if(localStorage.getItem($rootScope.currentCourseUrl+"currentScreenData")){$rootScope.userLastScreenData[0]=JSON.parse(localStorage.getItem($rootScope.currentCourseUrl+"currentScreenData"));$rootScope.initializeTopic($rootScope.userLastScreenData[0].topic_id,
"last_visited",true,true)}else $rootScope.initializeStudyRoom()};$rootScope.initializeVideoScreen=function(){$("#screen").html($compile('<div class="screen_panel video_screen_panel" id="video_screen">'+$rootScope.currentScreenContent+"</div>")($scope))};$rootScope.initializeHtmlScreen=function(){$scope.htmlContent=$sce.trustAsHtml($rootScope.currentScreenContent);$("#screen").html($compile('<div class="screen_panel" id="html_screen"><html-screen ng-bind-html="htmlContent"></html-screen></div>')($scope))};
$rootScope.initializeQuizScreen=function(navigatedFrom){$rootScope.quizQuestions=$rootScope.currentScreenData.quiz_questions;$rootScope.disableNextButton();if(navigatedFrom==="next"||navigatedFrom==="last_visited")$rootScope.currentQuizQuestionNumberToDisplay=0;else if(navigatedFrom==="prev")$rootScope.currentQuizQuestionNumberToDisplay=parseInt($rootScope.quizQuestions.length)-1;$("#screen").html($compile('<div class="screen_panel" id="quiz_screen"><quiz-screen data="quizQuestions"></quiz-screen></div>')($scope))};
$rootScope.initializeCodeChallengeScreen=function(){$rootScope.codeChallengeData=$rootScope.currentScreenData.code_challenge_details;$rootScope.codeChallengeData.content=$rootScope.currentScreenData.content;$rootScope.codeChallengeData.technologies={};$("#screen").html($compile('<div class="screen_panel" id="code_challenge_screen"><code-challenge-screen details="codeChallengeData" ></code-challenge-screen></div>')($scope))};$rootScope.updateUserScreenStatus=function(key){$http.get("/content/screen_submit/"+
$rootScope.currentCourseUrl+"/"+$rootScope.currentScreenId).success(function(data){if(data.success)$rootScope.currentTopicScreensData[key].status="viewed"})};$rootScope.nextButton=function(){if($rootScope.windowWidth<768){$("#next").addClass("animate_screen_navigaiton_button_class");$timeout(function(){$("#next").removeClass("animate_screen_navigaiton_button_class")},500)}if($rootScope.lastScreenData.screen_id==$rootScope.currentScreenId)if($rootScope.lastScreenData.topic_id==$rootScope.currentTopicId){if($rootScope.performSubmitButtonAction&&
$rootScope.isQuizQuestionAnswered){if($rootScope.quizQuestionAttemptedAnswer===$rootScope.quizQuestionCorrectAnswer){$rootScope.enableNextButton();$rootScope.isCorrectAnswer=true;$rootScope.displayQuizQuestionFeedback("success")}else $rootScope.displayQuizQuestionFeedback("error");return false}else if($rootScope.currentScreenType==="quiz")if(parseInt($rootScope.currentQuizQuestionNumber)+1<$rootScope.quizQuestions.length){$rootScope.loadQuizSubScreen(parseInt($rootScope.currentQuizQuestionNumber)+
1);return false}if(!$rootScope.isModuleTestSummaryScreenActive)$rootScope.showModuleTest();else $rootScope.showFinalTest();return false}if($rootScope.isModuleTestSummaryScreenActive){$rootScope.initializeTopic($rootScope.nextTopicId,"next",true,true);return}if($rootScope.performSubmitButtonAction&&$rootScope.isQuizQuestionAnswered)if($rootScope.quizQuestionAttemptedAnswer===$rootScope.quizQuestionCorrectAnswer){$rootScope.enableNextButton();$rootScope.isCorrectAnswer=true;$rootScope.displayQuizQuestionFeedback("success")}else $rootScope.displayQuizQuestionFeedback("error");
else{if($rootScope.currentScreenType==="quiz")if(parseInt($rootScope.currentQuizQuestionNumber)+1<$rootScope.quizQuestions.length){$rootScope.loadQuizSubScreen(parseInt($rootScope.currentQuizQuestionNumber)+1);return false}$.each($rootScope.screensNavigationData,function(key,value){if($rootScope.currentScreenId==value.screen_id&&$rootScope.currentTopicId==value.topic_id){$rootScope.nextTopicId=$rootScope.screensNavigationData[key+1].topic_id;$rootScope.nextModuleId=$rootScope.screensNavigationData[key+
1].module_id;$rootScope.nextScreenId=$rootScope.screensNavigationData[key+1].screen_id;$rootScope.prevTopicId=$rootScope.screensNavigationData[key+1].topic_id;$rootScope.prevModuleId=$rootScope.screensNavigationData[key+1].module_id;$rootScope.prevScreenId=$rootScope.screensNavigationData[key+1].screen_id;if($rootScope.nextTopicId!=$rootScope.currentTopicId){if($rootScope.nextModuleId!=$rootScope.currentModuleId){$rootScope.prevTopicId=$rootScope.screensNavigationData[key].topic_id;$rootScope.prevModuleId=
$rootScope.screensNavigationData[key].module_id;$rootScope.prevScreenId=$rootScope.screensNavigationData[key].screen_id;$rootScope.showModuleTest()}else $rootScope.initializeTopic($rootScope.nextTopicId,"next",true,false);return false}else{if($rootScope.nextScreenId==null)$rootScope.initializeTopic($rootScope.nextTopicId,"next",true,false);else $rootScope.initializeScreen($rootScope.nextScreenId,"next",false);return false}}})}};$rootScope.prevButton=function(){if($rootScope.windowWidth<768){$("#prev").addClass("animate_screen_navigaiton_button_class");
$timeout(function(){$("#prev").removeClass("animate_screen_navigaiton_button_class")},500)}if($rootScope.isFinalTestSummaryScreenActive){$rootScope.initializeModuleTest($rootScope.lastScreenData.module_id);return}if($rootScope.isModuleTestSummaryScreenActive){$rootScope.initializeTopic($rootScope.prevTopicId,"prev",true,true);return}$.each($rootScope.screensNavigationData,function(key,value){if($rootScope.currentScreenId==value.screen_id&&$rootScope.currentTopicId==value.topic_id){if($rootScope.currentScreenType===
"quiz"){$rootScope.enableNextButton();if(parseInt($rootScope.currentQuizQuestionNumber-1)<$rootScope.quizQuestions.length&&parseInt($rootScope.currentQuizQuestionNumber)-1>=0){$rootScope.loadQuizSubScreen(parseInt($rootScope.currentQuizQuestionNumber)-1);return false}}$rootScope.prevTopicId=$rootScope.screensNavigationData[key-1].topic_id;$rootScope.prevModuleId=$rootScope.screensNavigationData[key-1].module_id;$rootScope.prevScreenId=$rootScope.screensNavigationData[key-1].screen_id;if($rootScope.prevTopicId!=
$rootScope.currentTopicId){if($rootScope.prevModuleId!=$rootScope.currentModuleId){$rootScope.nextTopicId=$rootScope.screensNavigationData[key].topic_id;$rootScope.nextModuleId=$rootScope.screensNavigationData[key].module_id;$rootScope.nextScreenId=$rootScope.screensNavigationData[key].screen_id;$rootScope.currentModuleId=$rootScope.prevModuleId;$rootScope.currentModuleName=$rootScope.screensNavigationData[key-1].module_name;$rootScope.showModuleTest()}else $rootScope.initializeTopic($rootScope.prevTopicId,
"prev",true,false);return false}else{if($rootScope.prevScreenId==null)$rootScope.initializeTopic($rootScope.prevTopicId,"prev",true,false);else $rootScope.initializeScreen($rootScope.prevScreenId,"prev",false);return false}}})};$rootScope.showModuleTest=function(){$rootScope.isTestScreenActive=true;$rootScope.testScreenNavigationMessage="Module Test";$rootScope.onLoadingScreen=true;$rootScope.progressbar.start();$http.get("/module_test/index/"+$rootScope.currentCourseUrl+"/"+$rootScope.currentModuleId).success(function(data){$rootScope.isFinalTestSummaryScreenActive=
false;$rootScope.isFinalTestScreenActive=false;$("#next").show();$rootScope.enableNextButton();if(data.success){$rootScope.setCurrentUrlInLocalStorage("module_test/"+$rootScope.currentModuleId);$location.path("module_test/"+$rootScope.currentModuleId);$rootScope.totalModuleTestQuestions=data.module_test_data.no_of_questions;$rootScope.totalModuleTestQuestionsLeft=data.module_test_data.questions_left;$rootScope.currentModuleTestQuestion=$rootScope.totalModuleTestQuestions-$rootScope.totalModuleTestQuestionsLeft+
1;$rootScope.moduleTestTime=data.module_test_data.time;var divisorForMinutes=$rootScope.moduleTestTime%(60*60);var minutes=Math.floor(divisorForMinutes/60);var divisorForSeconds=divisorForMinutes%60;var seconds=Math.ceil(divisorForSeconds);if(seconds===0)seconds="00";$rootScope.moduleTestTimeToDispaly=minutes+" minutes "+seconds+" seconds";$rootScope.moduleTestQuestion=data.module_test_data.question[0];$rootScope.moduleTestQuesitonNumberToDisplay=0;$("#topic_screen_navigation_container").hide();$("#icon_navigation_container").html("");
if($rootScope.moduleTestQuestion!==null&&$rootScope.totalModuleTestQuestions===$rootScope.totalModuleTestQuestionsLeft)$rootScope.loadModuleTestStartResumeScreen("start");else if($rootScope.moduleTestQuestion===null||$rootScope.totalModuleTestQuestionsLeft===0)$rootScope.loadModuleTestSummaryScreen();else if($rootScope.moduleTestQuestion!==null&&$rootScope.totalModuleTestQuestions>$rootScope.totalModuleTestQuestionsLeft)$rootScope.loadModuleTestStartResumeScreen("resume")}else helperFunctions.showAlertMessage("error",
data.errorMessage,function(){$rootScope.redirectToLastVisitedScreen()})})};$rootScope.loadModuleTestStartResumeScreen=function(testType){$("#screen").html($compile('<div class="screen_panel" id="module_test_start_resume_screen"><module-test-start-resume-screen data="'+testType+'"></module-test-start-resume-screen></div>')($scope))};$rootScope.renderHtml=function(value){return $sce.trustAsHtml(value)};$rootScope.loadModuleTestSummaryScreen=function(){$http.get("/module_test/summary/"+$rootScope.currentCourseUrl+
"/"+$rootScope.currentModuleId).success(function(data){if(data.success){$rootScope.progressbar.complete();$rootScope.isModuleTestSummaryScreenActive=true;$rootScope.testScreenNavigationMessage="Module Test Summary";$rootScope.moduleTestSummaryData=data.summary_data.module_test_summary;$rootScope.moduleTestSummaryData.score=data.summary_data.score;$("#topic_screen_navigation_container").show();$("#prev").show();$("#next").show();$rootScope.enableNextButton();$("#screen").html($compile('<div class="screen_panel" id="module_test_summary_screen"><module-test-summary-screen ></module-test-summary-screen></div>')($scope));
$rootScope.getCourseMenu();$rootScope.currentModuleTestQuestion=1}else helperFunctions.showAlertMessage("error",data.errorMessage,function(){$rootScope.redirectToLastVisitedScreen();$rootScope.currentModuleTestQuestion=1})})};$rootScope.showFinalTest=function(){$(".module_test").removeClass("activetopic");$http.get("/final_test/index/"+$rootScope.currentCourseUrl).success(function(data){if(data.success){$rootScope.setCurrentUrlInLocalStorage("final_test/");$location.path("final_test/");$rootScope.isTestScreenActive=
true;$rootScope.isFinalTestScreenActive=true;$rootScope.testScreenNavigationMessage="Final Test";$rootScope.totalFinalTestQuestions=data.final_test_data.no_of_questions;$rootScope.totalFinalTestQuestionsLeft=data.final_test_data.questions.length;$rootScope.currentFinalTestQuestion=$rootScope.totalFinalTestQuestions-$rootScope.totalFinalTestQuestionsLeft+1;$rootScope.finalTestTime=data.final_test_data.time;var divisorForMinutes=$rootScope.finalTestTime%(60*60);var minutes=Math.floor(divisorForMinutes/
60);var divisorForSeconds=divisorForMinutes%60;var seconds=Math.ceil(divisorForSeconds);if(seconds===0)seconds="00";$rootScope.finalTestTimeToDispaly=minutes+" minutes "+seconds+" seconds";$rootScope.finalTestQuestions=data.final_test_data.questions;$rootScope.finalTestQuesitonNumberToDisplay=0;$("#topic_screen_navigation_container").hide();$("#icon_navigation_container").html("");if($rootScope.finalTestQuestions!==null&&$rootScope.totalFinalTestQuestions===$rootScope.finalTestQuestions.length)$rootScope.loadFinalTestStartResumeScreen("start");
else if($rootScope.finalTestQuestions===null||$rootScope.finalTestQuestions.length===0)$rootScope.loadFinalTestSummaryScreen();else if($rootScope.finalTestQuestions!==null&&$rootScope.totalFinalTestQuestions>$rootScope.finalTestQuestions.length)$rootScope.loadFinalTestStartResumeScreen("resume")}else helperFunctions.showAlertMessage("error",data.errorMessage,function(){$rootScope.redirectToLastVisitedScreen()})})};$rootScope.loadFinalTestStartResumeScreen=function(testType){$("#screen").html($compile('<div class="screen_panel" id="final_test_start_resume_screen"><final-test-start-resume-screen data="'+
testType+'"></final-test-start-resume-screen></div>')($scope))};$rootScope.loadFinalTestSummaryScreen=function(){$http.get("/final_test/summary/"+$rootScope.currentCourseUrl).success(function(data){if(data.success){$rootScope.isFinalTestSummaryScreenActive=true;$rootScope.testScreenNavigationMessage="Final Test Summary";$rootScope.isFinalTestScreenActive=true;$rootScope.finalTestSummaryData=data.final_test_summary_data.final_test_summary;$rootScope.finalTestSummaryData.score=data.final_test_summary_data.score;
$("#topic_screen_navigation_container").show();$("#next").hide();$("#prev").show();$("#screen").html($compile('<div class="screen_panel" id="final_test_summary_screen"><final-test-summary-screen></final-test-summary-screen></div>')($scope))}})};$scope.toggleCourseMenu=function(){$("#main_menu").slideToggle()};$rootScope.showLoadingImage=function(tag){$("#"+tag).html('<center><div style="margin:0px auto;"><img style="width:100px;" src="../../../static/images/loading.gif"></div></center>')};$rootScope.enableSubmitButton=
function(){if($rootScope.isQuizQuestionAnswered){$rootScope.performSubmitButtonAction=true;$("#next").removeClass("disable_click")}};$rootScope.changeNextToSubmitAndDisableSubmit=function(){if($rootScope.currentScreenType==="quiz"&&!$rootScope.isQuizQuestionAnswered){$("#next").html("Submit");$("#next").addClass("disable_click");$("#quiz_question_feedback").html("")}};$rootScope.enableNextButton=function(){$("#next").html("Next");$("#next").removeClass("disable_click");$rootScope.performSubmitButtonAction=
false;$rootScope.isQuizQuestionAnswered=false;$("#quiz_question_feedback").html("")};$rootScope.disableNextButton=function(){$("#next").html("Next");$("#next").addClass("disable_click")};$rootScope.showAnswerAndEnableNextButton=function(){$("#next").html("Next");$("#next").removeClass("disable_click");$rootScope.performSubmitButtonAction=false;$rootScope.isQuizQuestionAnswered=false;$rootScope.isCorrectAnswer=true;$("#show_answer").hide();$("#try_again").hide();$("#question_explanation").show()};
document.addEventListener("keydown",function(event){if(event.keyCode===32&&$rootScope.currentScreenType==="video"&&!$("#forum_search_input_filed").is(":focus")&&!$("#post_to_forum_text_area").is(":focus")){$scope.videoPlayer=document.getElementById("video_player");event.preventDefault();if(!$scope.videoPlayer.paused)$scope.videoPlayer.pause();else $scope.videoPlayer.play()}},false)}]);
vtcApp.requires.push("courseMenu","videoScreen","htmlScreen","quizScreen","quizSubScreen","iconNavigationMenu","quizErrorMessage","quizSuccessMessage","codeChallengeScreen","moduleTestScreen","moduleTestSummaryScreen","moduleTestStartResumeScreen","moduleTestQuestion","finalTestStartResumeScreen","finalTestScreen","finalTestQuestion","finalTestSummaryScreen","screenHelpers","helperText","forum","forumQuestion","overview","progressTracker","courseLiveChat","audioRecord","angularAudioRecorder","codeBox",
"tryYourself");vtcApp.config(["recorderServiceProvider",function(recorderServiceProvider){recorderServiceProvider.forceSwf(false).withMp3Conversion(true)}]);(function(ng){angular.module("overview",[]).directive("overview",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/overview/overview.html",controller:["$scope","$rootScope","$http","helperFunctions","contentCache","$sce",function($scope,$rootScope,$http,helperFunctions,contentCache,$sce){$scope.menu=$rootScope.menu;$scope.projectDescription=$sce.trustAsHtml($rootScope.projectDescription);$scope.currentCourseName=$rootScope.currentCourseName;$scope.overviewVideoUrl=
"/uploads/"+$rootScope.currentCourseUrl+"/content_media/"+$rootScope.currentCourseUrl+"_training_overview.mp4";$rootScope.onLoadingScreen=false;$scope.courseStatusButtonText="";$rootScope.progressbar.complete();$scope.changeHelperScreenTab=function(tab){if($("#"+tab).hasClass("active"))return;else{$(".tab-pane").removeClass("active");$("#"+tab).addClass("active")}};$scope.loadFaqs=function(){var requestUrl="/overview/faqs/"+$rootScope.currentCourseUrl;if(contentCache.get(requestUrl)){var cachedContent=
contentCache.get(requestUrl);$scope.faqs=cachedContent}else $http.get(requestUrl).success(function(data){if(data.success){$scope.faqs=data.faqs;contentCache.put(requestUrl,data.faqs)}})};$scope.loadChatTimings=function(){var requestUrl="/overview/chat_timings/"+$rootScope.currentCourseUrl;if(contentCache.get(requestUrl)){var cachedContent=contentCache.get(requestUrl);$scope.chatTimings=cachedContent}else $http.get(requestUrl).success(function(data){if(data.success){$scope.chatTimings=data.chat_timings;
contentCache.put(requestUrl,data.chat_timings)}})};$scope.courseStatus=function(){$http.get("/content/user_last_screen/"+$rootScope.currentCourseUrl).success(function(data){if(data.success)$scope.courseStatusButtonText="Resume course";else $scope.courseStatusButtonText="Go to course"})}}]}}])})(angular);(function(ng){angular.module("progressTracker",[]).directive("progressTracker",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/progress_tracker/progress_tracker.html",controller:["$scope","$rootScope","$http","$timeout","helperFunctions","$uibModal","$sce",function($scope,$rootScope,$http,$timeout,helperFunctions,$uibModal,$sce){$http.get("/progress_tracker/progress/"+$rootScope.currentCourseUrl).success(function(data){$scope.showAdditionalNoteForVideoDownload=
false;$scope.moduleIndex=0;$scope.progressTrackerData=data.progress_tracker_data;$rootScope.feedbackSubmitted=data.is_feedback_submitted;$rootScope.onLoadingScreen=false;$rootScope.trainingFeedback=$sce.trustAsHtml(data.progress_tracker_data.training_project.feedback);$rootScope.progressbar.complete()});$scope.setModuleIndex=function(index){$scope.moduleIndex=index};$scope.userDownloadMediaSubmit=function(mediaType,moduleId,moduleIndex,usecaseType){$rootScope.progressbar.start();$scope.formData={"type":mediaType,
"module_id":moduleId,"usecase_type":usecaseType};$http({method:"POST",url:"/progress_tracker/user_download_submit",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){if(response.data.success){$scope.progressTrackerData.modules[moduleIndex]["is_videos_downloaded"]=true;$rootScope.progressbar.complete()}else helperFunctions.showNotification("error","There is an error occured, please try again.")},function errorCallback(response){})};
$scope.userDownloadModalSubmit=function(mediaType,moduleId,moduleIndex,reason,reason_other,usecaseType){$rootScope.progressbar.start();$rootScope.progressVisible=true;$scope.formData={"type":mediaType,"module_id":moduleId,"reason":reason,"reason_other":reason_other,"usecase_type":usecaseType};$http({method:"POST",url:"/progress_tracker/user_download_submit",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){if(response.data.success){$rootScope.progressbar.complete();
$scope.progressTrackerData.is_user_downloaded_atleast_one_module_videos=true;$scope.progressTrackerData.modules[moduleIndex]["is_videos_downloaded"]=true;$rootScope.progressVisible=false;$("#user_media_download_modal").modal("toggle")}else helperFunctions.showNotification("error","There is an error occured, please try again.")},function errorCallback(response){})};$scope.setFiles=function(element){$scope.$apply(function(scope){scope.files=[];for(var i=0;i<element.files.length;i++){scope.files.push(element.files[i]);
$rootScope.disbaleUpload=false}$rootScope.progressVisible=false;$rootScope.progress=0})};$scope.uploadFile=function(fileType,moduleId){var fd=new FormData;for(var i in $scope.files)fd.append("uploadedFile",$scope.files[i]);var MB=1048576;var fileExtension=$scope.files[0]["name"].substr($scope.files[0]["name"].lastIndexOf(".")+1);if(fileExtension!=="zip"&&fileExtension!=="rar"){helperFunctions.showAlertMessage("error","Invalid file format. Please follow the instructions carefully or write to trainings@internshala.com if the problem continues.",
function(){});return}else if($scope.files[0]["size"]>20*MB){helperFunctions.showAlertMessage("error","File size too long. Please follow the instructions carefully or write to trainings@internshala.com if the problem continues.",function(){});return}if(fileType==="project"){$scope.fileType="project";$scope.UploadRequestUrl="/progress_tracker/upload_project/"}else{$scope.fileType="assignment";fd.append("module_id",moduleId);$scope.UploadRequestUrl="/progress_tracker/upload_module_assignment/"}var xhr=
new XMLHttpRequest;xhr.upload.addEventListener("progress",$scope.uploadProgress,false);xhr.addEventListener("load",$scope.uploadComplete,false);xhr.addEventListener("error",$scope.uploadFailed,false);xhr.addEventListener("abort",$scope.uploadCanceled,false);xhr.open("POST",$scope.UploadRequestUrl);xhr.send(fd);$rootScope.progressVisible=true;$rootScope.disbaleUpload=true};$scope.uploadProgress=function(evt){};$scope.uploadComplete=function(evt){$rootScope.progressVisible=false;$rootScope.disbaleUpload=
true;$scope.files=[];var data=JSON.parse(evt.target.responseText);$timeout(function(){if(data.success)if($scope.fileType==="project"){$scope.progressTrackerData.training_project.solution_uploaded=true;$scope.progressTrackerData.training_project.status="Under evaluation";$("#upload_project_modal").modal("toggle");helperFunctions.showNotification("success","Project uploaded successfully")}else{helperFunctions.showNotification("success","Assignment uploaded successfully");$("#upload_assignment_modal").modal("toggle");
$timeout(function(){$rootScope.initializeProgressTracker()},500)}else helperFunctions.showAlertMessage("error",data.errorMessage,function(){})},100)};$scope.uploadFailed=function(evt){alert("There was an error attempting to upload the file.")};$scope.uploadCanceled=function(evt){$scope.$apply(function(){$scope.progressVisible=false});alert("The upload has been canceled by the user or the browser dropped the connection.")}}]}}])})(angular);(function(ng){angular.module("courseMenu",[]).directive("courseMenu",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/course-menu.html",controller:["$scope","$rootScope",function($scope,$rootScope){}]}}])})(angular);(function(ng){angular.module("screenHelpers",[]).directive("screenHelpers",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/screen-helpers.html",controller:["$scope","$rootScope","$compile",function($scope,$rootScope,$compile){$scope.changeHelperScreenTab=function(tab,isClick){if($("#"+tab).hasClass("active"))return;else{$(".tab-pane").removeClass("active");$("#"+tab).addClass("active")}if(tab==="forum")$("#forum").html($compile("<forum></forum>")($scope))};
if(!$rootScope.helperTextContent)$scope.changeHelperScreenTab("forum",false)}]}}]).directive("compile",["$compile",function($compile){return function(scope,element,attrs){scope.$watch(function(scope){return scope.$eval(attrs.compile)},function(value){element.html(value);$compile(element.contents())(scope)})}}])})(angular);(function(ng){angular.module("helperText",[]).directive("helperText",[function(){return{restrict:"E",scope:{html:"="},replace:true,templateUrl:"/static/templates/content/helper-text.html",controller:["$scope","$rootScope",function($scope,$rootScope){$rootScope.tryYourself=function($event){var codeTag=angular.element($event.target).prev();var code=codeTag[0].innerHTML;var compiler=codeTag[0].attributes["compiler"].value;$("#try_yourself_code").val(code);$("#try_yourself_compiler").val(compiler);$("#submit_try_yourself_dock").click()}}]}}])})(angular);(function(ng){angular.module("forum",[]).directive("forum",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/forum.html",controller:["$scope","$rootScope","$timeout","$http","$compile","contentCache","helperFunctions",function($scope,$rootScope,$timeout,$http,$compile,contentCache,helperFunctions){$rootScope.forumResultQuestions=[];$scope.postYourQueryMessage="Ask your doubts to the instructor personally if they are not already answered on forum.";$scope.showSearch=
true;$scope.loadForumQuestions=function(){$rootScope.forumResultQuestions=[];var requestUrl="/forum/index/"+$rootScope.currentCourseUrl+"/"+$rootScope.currentTopicId;if(contentCache.get(requestUrl)){var cachedContent=contentCache.get(requestUrl);$timeout(function(){$scope.displayForumQuestions(cachedContent)},1E3)}else $http.get(requestUrl).success(function(data){$scope.displayForumQuestions(data);contentCache.put(requestUrl,data)})};$scope.loadForumQuestions();$scope.displayForumQuestions=function(data){if(data.success){$("#loading_error_message").hide();
$("#results_loading_error_message").hide();$("#results_container").removeClass("loading_wrapper");$("#forum_inner_container").show();if(data.forum_questions_data.length===0){$scope.showSearch=false;$("#loading_error_message").show();$scope.postYourQueryMessage="";$("#loading_error_message").html("<center>There are no questions in this forum currently. If you have any doubts, you can ask them to the instructor below.</center>");$scope.questionsLimit=0}else{$scope.questionsLimit=5;$scope.showSearch=
true;angular.forEach(data.forum_questions_data,function(question){$rootScope.forumResultQuestions.push(question)})}}else $("#results_loading_error_message").html("<center> Sorry :( <br> "+data.errorMessage+" </p></center>")};$scope.searchForum=function(e,keyword,isClick){if(e.keyCode!==13&&!isClick)return false;if(typeof keyword==="undefined"||keyword.length===0)return false;$("#results_loading_error_message").html(" <center>  <img alt='loading' src='../../../static/images/spinner_blue.gif' ></center>");
$("#results_loading_error_message").show();$("#results_container").addClass("loading_wrapper");var encodedUrl=encodeURI(keyword);$timeout(function(){$http.get("/forum/search_keyword/"+$rootScope.currentCourseUrl+"/"+encodedUrl).success(function(data){$rootScope.forumResultQuestions=[];$scope.showResetButton=true;$scope.postYourQueryMessage="If your query is not answered on forum, you can ask the instructor personally.";$scope.displayForumQuestions(data)})},3E3)};$scope.loadMoreQuestions=function(){$scope.questionsLimit=
$scope.questionsLimit+5};$scope.submitForumQuestion=function(){$rootScope.progressbar.start();$scope.formData={"question":$scope.forumQuestionToSubmit,"course_url":$rootScope.currentCourseUrl,"topic_id":$rootScope.currentTopicId,"module_id":$rootScope.currentModuleId};$http({method:"POST",url:"/forum/question_submit",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){$rootScope.progressbar.complete();
if(response.data.success){helperFunctions.showNotification("success","Your query is submitted to instructor. You will receive a reply in 24-48 hours in your email.");$scope.forumQuestionToSubmit=null}else helperFunctions.showAlertMessage("error",response.data.errorMessage,function(){})},function errorCallback(response){})};$scope.resetForum=function(){$("#forum").html($compile("<forum></forum>")($scope))}}]}}])})(angular);(function(ng){angular.module("forumQuestion",[]).directive("forumQuestion",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/forum-question.html",controller:["$scope","$sce","$rootScope","$timeout",function($scope,$sce,$rootScope,$timeout){$scope.htmlAnswer=$sce.trustAsHtml($scope.data.answer);$timeout(function(){$scope.tempHeigthVariable=$("#forum_question_"+$scope.data.id).innerHeight()},1E3);$timeout(function(){$scope.answerDivActualHeight=$scope.tempHeigthVariable;
if($scope.answerDivActualHeight>100)$scope.answerDivMaxHeight=100;else $scope.answerDivMaxHeight=$scope.answerDivActualHeight},1E3)}]}}])})(angular);(function(ng){angular.module("videoScreen",[]).directive("videoScreen",[function(){return{restrict:"E",scope:{src:"@"},replace:true,templateUrl:"/static/templates/content/screens/video-screen.html",controller:["$document","$scope","$rootScope","$http","$window","$timeout",function($document,$scope,$rootScope,$http,$window,$timeout){$scope.initializeVideoPlayer=function(){$rootScope.hasResolutions=false;$scope.videoPlayer=document.getElementById("video_player");$scope.tagToSearch=$scope.src.split(".");
$scope.tagToSearch=$scope.tagToSearch[0].split("/");$scope.tagToSearchIndex=$scope.tagToSearch.length;$http.get("/content/get_video_versions/"+$rootScope.currentCourseUrl+"/"+$scope.tagToSearch[$scope.tagToSearchIndex-1]).success(function(data){$scope.videoResolutions=data.videos;if(typeof data.videos!=="undefined")if(Object.keys($scope.videoResolutions).length>1){$rootScope.hasResolutions=true;$.each($scope.videoResolutions,function(key,value){$scope.src="/uploads/"+$rootScope.currentCourseUrl+"/content_media/"+
value;return false})}else $("#controls").hide();else $("#controls").hide()})};$(document).ready(function(){$("video").bind("contextmenu",function(){return false});$("video").mouseover(function(){if($rootScope.hasResolutions)$("#controls").css("opacity","1")});$("video").mouseout(function(){if($rootScope.hasResolutions)$("#controls").css("opacity","0")});$("#controls").mouseover(function(){if($rootScope.hasResolutions)$("#controls").css("opacity","1")});$("video").click(function(){$scope.videoPlayer=
document.getElementById("video_player");if(navigator.userAgent.indexOf("Firefox")!==-1)if($scope.videoPlayer.paused)$("#video_player").play();else $("#video_player").pause();else if(!$scope.videoPlayer.paused)$scope.videoPlayer.pause();else $scope.videoPlayer.play()})});$scope.changeVideoQuality=function(){$scope.videoPauseTime=$scope.videoPlayer.currentTime;if(!$scope.videoPlayer.paused)$scope.initScreenShot();$scope.src="";$timeout(function(){$scope.src=$scope.selectedItem;$("#video_player_inner_container").height($("video").height())},
1E3);$scope.videoPlayer.addEventListener("loadedmetadata",function(){this.currentTime=$scope.videoPauseTime;$scope.videoPlayer.play()},false);$scope.videoPlayer.addEventListener("playing",function(){$("#canvas").hide()},false)};$scope.initScreenShot=function(){var videoHeight=$scope.videoPlayer.videoHeight;var videoWidth=$scope.videoPlayer.videoWidth;var canvas=document.getElementById("canvas");var ctx=canvas.getContext("2d");canvas.width=videoWidth;canvas.height=videoHeight;ctx.drawImage($scope.videoPlayer,
0,0,videoWidth,videoHeight);$("#canvas").show();return true}}]}}])})(angular);(function(ng){angular.module("htmlScreen",[]).directive("htmlScreen",[function(){return{restrict:"E",scope:{html:"="},replace:true,templateUrl:"/static/templates/content/screens/html-screen.html",controller:["$scope","$timeout","$compile",function($scope,$timeout,$compile){$timeout(function(){if($("#audio_record").get(0)){$scope.src=$("#audio_record").get(0).getAttribute("src");$("#audio_record").html($compile("<audio-record src='src'></audio-record>")($scope))}},1E3)}]}}])})(angular);(function(ng){angular.module("quizScreen",[]).directive("quizScreen",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/screens/quiz-screen.html",controller:["$timeout","$scope","$compile","$rootScope","$http",function($timeout,$scope,$compile,$rootScope,$http){$rootScope.loadQuizSubScreen=function(question_number){$rootScope.currentQuizQuestionNumber=question_number;$rootScope.showCorrectPercentageMessage=false;$scope.subScreenData=$scope.data[question_number];
$rootScope.changeNextToSubmitAndDisableSubmit();$rootScope.isCorrectAnswer=false;$("#quiz_sub_screen_container").html(" <center>  <img style='margin-top:100px;' alt='loading' src='../../../static/images/spinner_blue.gif' ></center>");$timeout(function(){$("#quiz_sub_screen_container").html($compile('<quiz-sub-screen data="subScreenData">  </quiz-sub-screen>')($scope))},500)};$rootScope.loadQuizSubScreen($rootScope.currentQuizQuestionNumberToDisplay);$rootScope.displayQuizQuestionFeedback=function(status){$("#quiz_question_feedback").html(" ");
$timeout(function(){if(status==="success"){$scope.answer=1;$("#quiz_question_feedback").html($compile('<quiz-success-message data="subScreenData"></quiz-success-message>')($scope))}else if(status==="error"){$scope.answer=0;$("#quiz_question_feedback").html($compile('<quiz-error-message data="subScreenData"></quiz-error-message>')($scope))}$scope.formData={"question_id":$scope.subScreenData.id,"is_correct":$scope.answer};$http({method:"POST",url:"/content/quiz_question_submit",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},
data:$.param($scope.formData)}).then(function successCallback(response){if(response.data.success)if(response.data.quiz_question_data.hasOwnProperty("correctRate"))if(response.data.quiz_question_data.correctRate!=0){$rootScope.showCorrectPercentageMessage=true;$rootScope.correctPercentage=response.data.quiz_question_data.correctRate}},function errorCallback(response){})},100)}}]}}])})(angular);(function(ng){angular.module("quizSubScreen",[]).directive("quizSubScreen",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/screens/quiz/quiz-sub-screen.html",controller:["$scope","$rootScope","$sce",function($scope,$rootScope,$sce){$("#quiz_question_feedback").html("");$scope.quizQuestion=$sce.trustAsHtml($scope.data["question"]);$scope.questionOptions=new Array;for(var i=1;i<=5;i++)if($scope.data["option"+i]!==null&&$scope.data["option"+i]!=="")$scope.questionOptions.push($scope.data["option"+
i]);$scope.selectQuizAnswer=function(index,answer){if(!$rootScope.isCorrectAnswer){$rootScope.isQuizQuestionAnswered=true;$rootScope.quizQuestionAttemptedAnswer=parseInt(index+1);$rootScope.quizQuestionCorrectAnswer=parseInt(answer);$rootScope.enableSubmitButton()}}}]}}])})(angular);(function(ng){angular.module("quizErrorMessage",[]).directive("quizErrorMessage",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/screens/quiz/quiz-error-message.html",controller:["$scope","$rootScope",function($scope,$rootScope){var option="option"+$scope.data.answer;$scope.correctAnswer=$scope.data[option];$scope.showAnswer=function(){$rootScope.showAnswerAndEnableNextButton()}}]}}])})(angular);(function(ng){angular.module("quizSuccessMessage",[]).directive("quizSuccessMessage",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/screens/quiz/quiz-success-message.html",controller:["$scope","$rootScope",function($scope,$rootScope){}]}}])})(angular);(function(ng){angular.module("iconNavigationMenu",[]).directive("iconNavigationMenu",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/icon-navigation-menu.html",controller:["$scope",function($scope){}]}}])})(angular);(function(ng){angular.module("codeChallengeScreen",[]).directive("codeChallengeScreen",[function(){return{restrict:"E",scope:{details:"="},replace:true,templateUrl:"/static/templates/content/screens/code-challenge-screen.html",controller:["$scope","$rootScope","$http","$sce","$timeout","$compile",function($scope,$rootScope,$http,$sce,$timeout,$compile){console.log("Code challenge");$scope.checkCodeMirrorAvailability=function(){console.log("a");if(typeof CodeMirror!=="undefined"){clearInterval($scope.availability);
$rootScope.loadCodeBox()}};$rootScope.loadCodeBox=function(){$scope.details.codeBoxOptions={showSolutionTab:true,showFullScreen:false,showSublimeThemeOption:false,showFontChooser:false,showTechnologies:false,isCodeChallenge:true,theme:"default",font:"normal"};$("#code_box").html($compile('<code-box data="details"></code-box>')($scope))};if($scope.details){$scope.problemStatement=$sce.trustAsHtml($scope.details.content);if(typeof CodeMirror==="undefined"){$timeout(function(){postscribe("#head","<script src='/node_modules/codemirror/lib/codemirror.js'>\x3c/script>");
postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/lib/codemirror.css'>");postscribe("#head","<script src='/node_modules/codemirror/mode/htmlmixed/htmlmixed.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/php/php.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/css/css.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/javascript/javascript.js'>\x3c/script>");postscribe("#head",
"<script src='/node_modules/codemirror/mode/xml/xml.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/clike/clike.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/selection/active-line.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/edit/closetag.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/edit/closebrackets.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/display/fullscreen.js'>\x3c/script>");
postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/addon/display/fullscreen.css'>");postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/theme/monokai.css'>")},1E3);$scope.availability=setInterval($scope.checkCodeMirrorAvailability,500)}else{console.log("codemirror present");$rootScope.loadCodeBox()}}else;}]}}])})(angular);(function(ng){angular.module("moduleTestScreen",[]).directive("moduleTestScreen",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/screens/module_test/module-test-screen.html",controller:["$scope","$rootScope","$http","$compile","$timeout",function($scope,$rootScope,$http,$compile,$timeout){$rootScope.loadModuleTestQuestion=function(question){$scope.questionData=question;$scope.marks=$scope.questionData["marks"];$("#module_test_question_container").html($compile('<module-test-question data="questionData"></module-test-question>')($scope))};
$rootScope.loadModuleTestQuestion($rootScope.moduleTestQuestion);$rootScope.counter=$rootScope.moduleTestTime;$scope.seconds=$rootScope.counter%60;$scope.countdown=function(){$rootScope.stopped=$timeout(function(){if($scope.seconds!==0)$scope.seconds--;else $scope.seconds=59;if($scope.seconds<10&&$scope.seconds>0)$scope.seconds="0"+$scope.seconds;$rootScope.counter--;if($rootScope.counter===0){$scope.minutes="00";$scope.seconds="00";$scope.submitAllUnAnsweredQuestions()}else{$scope.minutes=Math.floor($rootScope.counter/
60);if($scope.minutes<10&&$scope.minutes>=0)$scope.minutes="0"+$scope.minutes;$scope.countdown()}},1E3)};$scope.countdown();$scope.submitAllUnAnsweredQuestions=function(){$rootScope.progressbar.start();$http.get("/module_test/unanswered_questions_submit/"+$rootScope.currentCourseUrl+"/"+$rootScope.currentModuleId).success(function(data){$rootScope.loadModuleTestSummaryScreen()})}}]}}])})(angular);(function(ng){angular.module("moduleTestSummaryScreen",[]).directive("moduleTestSummaryScreen",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/screens/module_test/module-test-summary-screen.html",controller:["$scope","$rootScope",function($scope,$rootScope){$rootScope.onLoadingScreen=false;$rootScope.progressbar.complete()}]}}])})(angular);(function(ng){angular.module("moduleTestStartResumeScreen",[]).directive("moduleTestStartResumeScreen",[function(){return{restrict:"E",scope:{data:"@"},replace:true,templateUrl:"/static/templates/content/screens/module_test/module-test-start-resume-screen.html",controller:["$scope","$rootScope","$compile","$timeout",function($scope,$rootScope,$compile,$timeout){$rootScope.onLoadingScreen=false;$rootScope.progressbar.complete();$rootScope.loadModuleTestScreen=function(){$("#screen").html($compile('<div class="screen_panel" id="module_test_screen"><module-test-screen></module-test-screen></div>')($scope))};
$timeout.cancel($rootScope.stopped)}]}}])})(angular);(function(ng){angular.module("moduleTestQuestion",[]).directive("moduleTestQuestion",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/screens/module_test/module-test-question.html",controller:["$scope","$rootScope","$http",function($scope,$rootScope,$http){$rootScope.moduleTestSelectedOption=0;$scope.updateSelectedOption=function(option){$rootScope.moduleTestSelectedOption=option};$rootScope.moduleTestQuestionSubmit=function(){$rootScope.progressbar.start();
$scope.formData={"question_id":$scope.data.id,"module_id":$rootScope.currentModuleId,"attempted_answer":$rootScope.moduleTestSelectedOption,"submitted_time":$rootScope.counter};$http({method:"POST",url:"/module_test/question_submit",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){$rootScope.totalModuleTestQuestionsLeft--;if($rootScope.totalModuleTestQuestionsLeft>0){$rootScope.progressbar.complete();
$rootScope.currentModuleTestQuestion++;$rootScope.loadModuleTestQuestion(response.data.next_question[0])}else $rootScope.loadModuleTestSummaryScreen()},function errorCallback(response){})}}]}}])})(angular);(function(ng){angular.module("finalTestStartResumeScreen",[]).directive("finalTestStartResumeScreen",[function(){return{restrict:"E",scope:{data:"@"},replace:true,templateUrl:"/static/templates/content/screens/final_test/final-test-start-resume-screen.html",controller:["$scope","$rootScope","$compile","$timeout",function($scope,$rootScope,$compile,$timeout){$rootScope.onLoadingScreen=false;$rootScope.progressbar.complete();$timeout.cancel($rootScope.stopped);$rootScope.loadfinalTestScreen=function(){$("#screen").html($compile('<div class="screen_panel" id="final_test_screen"><final-test-screen></final-test-screen></div>')($scope))}}]}}])})(angular);(function(ng){angular.module("finalTestScreen",[]).directive("finalTestScreen",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/screens/final_test/final-test-screen.html",controller:["$scope","$rootScope","$compile","$http","$timeout",function($scope,$rootScope,$compile,$http,$timeout){$rootScope.loadFinalTestQuestion=function(){$scope.questionData=$rootScope.finalTestQuestions[$rootScope.finalTestQuesitonNumberToDisplay];$scope.marks=$scope.questionData["marks"];
$("#final_test_question_container").html($compile('<final-test-question data="questionData"></final-test-question>')($scope))};$rootScope.loadFinalTestQuestion();$rootScope.counter=$rootScope.finalTestTime;$scope.seconds=$rootScope.counter%60;$scope.countdown=function(){$rootScope.stopped=$timeout(function(){if($scope.seconds!==0)$scope.seconds--;else $scope.seconds=59;if($scope.seconds<10&&$scope.seconds>0)$scope.seconds="0"+$scope.seconds;$rootScope.counter--;if($rootScope.counter===0)$scope.submitAllUnAnsweredQuestions();
$scope.minutes=Math.floor($rootScope.counter/60);if($scope.minutes<10&&$scope.minutes>=0)$scope.minutes="0"+$scope.minutes;$scope.countdown()},1E3)};$scope.countdown();$scope.submitAllUnAnsweredQuestions=function(){$http.get("/final_test/unanswered_questions_submit/"+$rootScope.currentCourseUrl).success(function(data){$rootScope.loadFinalTestSummaryScreen()})}}]}}])})(angular);(function(ng){angular.module("finalTestQuestion",[]).directive("finalTestQuestion",[function(){return{restrict:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/screens/final_test/final-test-question.html",controller:["$scope","$rootScope","$http",function($scope,$rootScope,$http){$rootScope.finalTestSelectedOption=0;$scope.updateSelectedOption=function(option){$rootScope.finalTestSelectedOption=option};$rootScope.finalTestQuestionSubmit=function(){$rootScope.progressbar.start();
$scope.formData={"question_id":$scope.data.id,"attempted_answer":$rootScope.finalTestSelectedOption,"submitted_time":$rootScope.counter};$http({method:"POST",url:"/final_test/question_submit",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){$rootScope.progressbar.complete();$rootScope.finalTestQuesitonNumberToDisplay++;if($rootScope.finalTestQuesitonNumberToDisplay<$rootScope.finalTestQuestions.length){$rootScope.currentFinalTestQuestion++;
$rootScope.loadFinalTestQuestion()}else $rootScope.loadFinalTestSummaryScreen()},function errorCallback(response){})}}]}}])})(angular);(function(ng){angular.module("finalTestSummaryScreen",[]).directive("finalTestSummaryScreen",[function(){return{restrict:"E",scope:{},replace:true,templateUrl:"/static/templates/content/screens/final_test/final-test-summary-screen.html",controller:["$scope","$rootScope",function($scope,$rootScope){$rootScope.onLoadingScreen=false;$rootScope.progressbar.complete()}]}}])})(angular);(function(ng){angular.module("courseLiveChat",[]).directive("courseLiveChat",[function(){return{restrict:"E",replace:true,template:'<div><div ng-show="showCourseLiveChat" id="course_live_chat"><p>{{time}}</p></div></div>',controller:["$scope","$rootScope","$timeout","$http","helperFunctions",function($scope,$rootScope,$timeout,$http,helperFunctions){$scope.showCourseLiveChat=false;$scope.loadLiveChat=function(){$http.get("/overview/live_chat/"+$rootScope.currentCourseUrl).success(function(data){$scope.checkStatus=
function(){var now=(new Date).getTime();var distance=end-now;if(distance<0){clearInterval(CheckChatinterval);$timeout(function(){$scope.loadLiveChat()},1E3);return}};if(data.success)if(data.live_chat_status.is_available){$scope.showCourseLiveChat=true;$scope.time=data.live_chat_status.status==="ended"?data.live_chat_status.next_live_chat.message:data.live_chat_status.message;if(data.live_chat_status.status==="yet_to_start"||data.live_chat_status.status==="in_progress"){var currentTime=data.live_chat_status.str_current_time*
1E3;var endTime=data.live_chat_status.status==="yet_to_start"?data.live_chat_status.str_start_time*1E3:data.live_chat_status.str_end_time*1E3;var currentTime=(new Date).getTime();var end=endTime-currentTime+currentTime;var CheckChatinterval=setInterval($scope.checkStatus,1E4)}if(data.live_chat_status.status==="in_progress"){$scope.showCourseLiveChat=false;$scope.liveChatUrl="https://mylivechat.com/chatinline.aspx?hccid="+data.live_chat_status.chat_id;postscribe("#head","<script src="+$scope.liveChatUrl+
">\x3c/script>")}else $(".mylivechat_inline").hide()}})};$timeout(function(){if($rootScope.windowWidth>768)$scope.loadLiveChat()},2E3)}]}}])})(angular);/*
 SWFObject v2.1 <http://code.google.com/p/swfobject/>
     Copyright (c) 2007-2008 Geoff Stearns, Michael Williams, and Bobby van der Sluis
     This software is released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
(function(){window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;angular.module("angularAudioRecorder",["angularAudioRecorder.config","angularAudioRecorder.services","angularAudioRecorder.controllers","angularAudioRecorder.directives"]);angular.module("angularAudioRecorder.config",[]).constant("recorderScriptUrl",
function(){var scripts=document.getElementsByTagName("script");var myUrl=scripts[scripts.length-1].getAttribute("src");var path=myUrl.substr(0,myUrl.lastIndexOf("/")+1);var a=document.createElement("a");a.href=path;return a.href}()).constant("recorderPlaybackStatus",{STOPPED:0,PLAYING:1,PAUSED:2});angular.module("angularAudioRecorder.controllers",["angularAudioRecorder.config","angularAudioRecorder.services"]);var createReadOnlyVersion=function(object){var obj={};for(var property in object)if(object.hasOwnProperty(property))Object.defineProperty(obj,
property,{get:function(a){var p=a;return function(){return object[p]}}(property),enumerable:true,configurable:true});return obj};var blobToDataURL=function(blob,callback){var a=new FileReader;a.onload=function(e){callback(e.target.result)};a.readAsDataURL(blob)};var RecorderController=function(element,service,recorderUtils,$scope,$timeout,$interval,PLAYBACK,$http){var scopeApply=function(fn){var phase=$scope.$root.$$phase;if(phase!=="$apply"&&phase!=="$digest");};var control=this,cordovaMedia={recorder:null,
url:null,player:null},timing=null,uploadTime=null,audioObjId="recorded-audio-"+control.id,status={isRecording:false,playback:PLAYBACK.STOPPED,isDenied:null,isEmbeded:false,audioRecorderReady:false,isSwfLoaded:null,isConverting:false,get isPlaying(){return status.playback===PLAYBACK.PLAYING},get isStopped(){return status.playback===PLAYBACK.STOPPED},get isPaused(){return status.playback===PLAYBACK.PAUSED}},shouldConvertToMp3=angular.isDefined(control.convertMp3)?!!control.convertMp3:service.shouldConvertToMp3(),
mp3Converter=shouldConvertToMp3?new MP3Converter(service.getMp3Config()):null;control.timeLimit=control.timeLimit||0;control.buttonStatus="Start Recording";status.audioRecorderReady=false;console.log(control.currentCourseUrl);console.log(control.currentScreenId);console.log(control.src);control.status=createReadOnlyVersion(status);control.isAvailable=service.isAvailable();control.elapsedTime=0;control.uploadTimeCount=0;if(!control.id){control.id=recorderUtils.generateUuid();element.attr("id",control.id)}if(!service.isHtml5&&
!service.isCordova){status.isSwfLoaded=service.swfIsLoaded();$scope.$watch(function(){return service.swfIsLoaded()},function(n){status.isSwfLoaded=n})}service.setController(control.id,this);var initialAudioPlayerIfUserAudioPresent=function(){$http.get("/content/get_user_recordings/"+control.currentCourseUrl+"/"+control.currentScreenId).success(function(response){if(response.success)if(response.file!==null){var config={responseType:"blob"};$http.get("/uploads/"+control.currentCourseUrl+"/uploads/recordings/"+
response.file,config).success(function(data){var blob=data;control.audioModel=blob;control.buttonStatus="Record Again";status.audioRecorderReady=true;embedPlayer(blob);console.log(control.audioModel)})}else status.audioRecorderReady=true})};initialAudioPlayerIfUserAudioPresent();var playbackOnEnded=function(){status.playback=PLAYBACK.STOPPED;control.onPlaybackComplete();scopeApply()};var playbackOnPause=function(){status.playback=PLAYBACK.PAUSED;control.onPlaybackPause()};var playbackOnStart=function(){status.playback=
PLAYBACK.PLAYING;control.onPlaybackStart()};var playbackOnResume=function(){status.playback=PLAYBACK.PLAYING;control.onPlaybackResume()};var embedPlayer=function(blob){if(document.getElementById(audioObjId)==null){element.prepend('<audio style="width:100%; margin-bottom:5px;" type="audio/mp3" id="'+audioObjId+'"></audio>');element.prepend('<p id="your_solution">Your solution:</p>');var audioPlayer=document.getElementById(audioObjId);if(control.showPlayer)audioPlayer.setAttribute("controls","");audioPlayer.addEventListener("ended",
playbackOnEnded);audioPlayer.addEventListener("pause",function(e){if(this.duration!==this.currentTime){playbackOnPause();scopeApply()}});status.isEmbeded=true;audioPlayer.addEventListener("playing",function(e){if(status.isPaused)playbackOnResume();else playbackOnStart();scopeApply()})}$("#trainer_audio").show();if(blob)blobToDataURL(blob,function(url){document.getElementById(audioObjId).src=url});else document.getElementById(audioObjId).removeAttribute("src")};var doMp3Conversion=function(blobInput,
successCallback){if(mp3Converter){status.isConverting=true;mp3Converter.convert(blobInput,function(mp3Blob){status.isConverting=false;if(successCallback)successCallback(mp3Blob);scopeApply(control.onConversionComplete)},function(){status.isConverting=false});control.onConversionStart()}};control.getAudioPlayer=function(){return service.isCordova?cordovaMedia.player:document.getElementById(audioObjId)};control.askPermissions=function(){console.log("as");var recordHandler=service.getHandler();if(!status.isDenied)service.showPermission({onDenied:function(){status.isDenied=
true},onAllowed:function(){status.isDenied=false;scopeApply()}})};control.startMicroPhoneTesting=function(){if(!service.isAvailable())return;control.audioModel=null;var id=control.id,recordHandler=service.getHandler();var start=function(){if(service.isHtml5){if(!recordHandler)return;console.log("HTML5RecordingTest");recordHandler.clear();recordHandler.record()}else return;control.onRecordStart()};if(recordHandler)start();else if(!status.isDenied)service.showPermission({onDenied:function(){status.isDenied=
true},onAllowed:function(){status.isDenied=false;recordHandler=service.getHandler();start();scopeApply()}})};control.startRecord=function(){if(control.buttonStatus==="Record Again"){control.buttonStatus="Start Recording";document.getElementById(audioObjId).remove();document.getElementById("your_solution").remove();$("#trainer_audio").hide();return}if(!service.isAvailable())return;if(status.isPlaying){control.playbackPause();status.playback=PLAYBACK.STOPPED}control.audioModel=null;var id=control.id,
recordHandler=service.getHandler();var start=function(){if(service.isCordova){cordovaMedia.url=recorderUtils.cordovaAudioUrl(control.id);cordovaMedia.recorder=new Media(cordovaMedia.url,function(){console.log("Media successfully played")},function(err){console.log("Media could not be launched"+err.code,err)});console.log("CordovaRecording");cordovaMedia.recorder.startRecord()}else if(service.isHtml5){if(!recordHandler)return;console.log("HTML5Recording");recordHandler.clear();recordHandler.record()}else{if(!service.isReady)return;
console.log("FlashRecording");recordHandler.record(id,"audio.wav")}control.uploadTimeCount=0;status.isRecording=true;control.onRecordStart();control.elapsedTime=0;timing=$interval(function(){++control.elapsedTime;if(control.timeLimit&&control.timeLimit>0&&control.elapsedTime>=control.timeLimit)control.stopRecord();var minutes=Math.floor(control.elapsedTime/60);var seconds=control.elapsedTime-minutes*60;control.buttonStatus="Recording.."+"("+str_pad_left(minutes,"0",2)+":"+str_pad_left(seconds,"0",
2)+")"},1E3)};var str_pad_left=function(string,pad,length){return((new Array(length+1)).join(pad)+string).slice(-length)};if(service.isCordova||recordHandler)start();else if(!status.isDenied)service.showPermission({onDenied:function(){status.isDenied=true},onAllowed:function(){status.isDenied=false;recordHandler=service.getHandler();start();scopeApply()}})};control.stopRecord=function(){var id=control.id;if(!service.isAvailable()||!status.isRecording)return false;var recordHandler=service.getHandler();
var completed=function(blob){$interval.cancel(timing);status.isRecording=false;control.buttonStatus="Saving..";var finalize=function(inputBlob){control.audioModel=inputBlob;control.save(null,buttonStatuChange)};if(shouldConvertToMp3)doMp3Conversion(blob,finalize);else finalize(blob);var buttonStatuChange=function(status){console.log("in change fun");control.buttonStatus=status};control.onRecordComplete()};if(service.isCordova){cordovaMedia.recorder.stopRecord();window.resolveLocalFileSystemURL(cordovaMedia.url,
function(entry){entry.file(function(blob){completed(blob)})},function(err){console.log("Could not retrieve file, error code:",err.code)})}else if(service.isHtml5){recordHandler.stop();recordHandler.getBuffer(function(){recordHandler.exportWAV(function(blob){completed(blob);scopeApply()})})}else{recordHandler.stopRecording(id);completed(recordHandler.getBlob(id))}};control.playbackRecording=function(){if(status.isPlaying||!service.isAvailable()||status.isRecording||!control.audioModel)return false;
if(service.isCordova){cordovaMedia.player=new Media(cordovaMedia.url,playbackOnEnded,function(){console.log("Playback failed")});cordovaMedia.player.play();playbackOnStart()}else control.getAudioPlayer().play()};control.playbackPause=function(){if(!status.isPlaying||!service.isAvailable()||status.isRecording||!control.audioModel)return false;control.getAudioPlayer().pause();if(service.isCordova)playbackOnPause()};control.playbackResume=function(){if(status.isPlaying||!service.isAvailable()||status.isRecording||
!control.audioModel)return false;if(status.isPaused){control.getAudioPlayer().play();if(service.isCordova)playbackOnResume()}else control.playbackRecording()};control.save=function(fileName,successCallBack){if(!service.isAvailable()||status.isRecording||!control.audioModel)return false;console.log("save");if(!fileName)fileName="recording"+(control.audioModel.type.indexOf("mp3")>-1?".mp3":".wav");var blobUrl=(window.URL||window.webkitURL).createObjectURL(control.audioModel);var a=document.createElement("a");
a.href=blobUrl;a.target="_blank";a.download=fileName;var click=document.createEvent("Event");click.initEvent("click",true,true);a.dispatchEvent(click);console.log(fileName);console.log(a);var file=new File([control.audioModel],fileName);var fd=new FormData;fd.append("file",file);fd.append("course_url",control.currentCourseUrl);fd.append("screen_id",control.currentScreenId);var xhr=new XMLHttpRequest;uploadTime=$interval(function(){control.uploadTimeCount++},1E3);xhr.addEventListener("load",function(){successCallBack("Record Again");
console.log("load");$timeout(function(){embedPlayer(control.audioModel)},1E3);$interval.cancel(uploadTime)},false);xhr.addEventListener("error",function(){alert("There was an error attempting to upload the file.");control.buttonStatus="Record Again"},false);xhr.addEventListener("abort",function(){alert("The upload has been canceled by the user or the browser dropped the connection.");control.buttonStatus="Record Again"},false);xhr.open("POST","/content/upload_user_recordings/");xhr.send(fd)};$scope.uploadComplete=
function(evt){};$scope.uploadFailed=function(evt){alert("There was an error attempting to upload the file.")};$scope.uploadCanceled=function(evt){alert("The upload has been canceled by the user or the browser dropped the connection.")};control.isHtml5=function(){return service.isHtml5};if(control.autoStart)$timeout(function(){control.startRecord()},1E3);element.on("$destroy",function(){$interval.cancel(timing)})};RecorderController.$inject=["$element","recorderService","recorderUtils","$scope","$timeout",
"$interval","recorderPlaybackStatus","$http"];angular.module("angularAudioRecorder.controllers").controller("recorderController",RecorderController);angular.module("angularAudioRecorder.directives",["angularAudioRecorder.config","angularAudioRecorder.services","angularAudioRecorder.controllers"]);angular.module("angularAudioRecorder.directives").directive("ngAudioRecorderAnalyzer",["recorderService","recorderUtils",function(service,utils){var link=function(scope,element,attrs,recorder){if(!service.isHtml5){scope.hide=
true;return}var canvasWidth,canvasHeight,rafID,analyserContext,props=service.$html5AudioProps;function updateAnalysers(time){if(!analyserContext){var canvas=element.find("canvas")[0];if(attrs.width&&!isNaN(attrs.width))canvas.width=attrs.width;if(attrs.height&&!isNaN(attrs.height))canvas.height=parseInt(attrs.height);canvasWidth=canvas.width;canvasHeight=canvas.height;analyserContext=canvas.getContext("2d")}{var SPACING=3;var BAR_WIDTH=1;var numBars=Math.round(canvasWidth/SPACING);var freqByteData=
new Uint8Array(props.analyserNode.frequencyBinCount);props.analyserNode.getByteFrequencyData(freqByteData);analyserContext.clearRect(0,0,canvasWidth,canvasHeight);analyserContext.lineCap="round";var multiplier=props.analyserNode.frequencyBinCount/numBars;for(var i=0;i<numBars;++i){var magnitude=0;var offset=Math.floor(i*multiplier);for(var j=0;j<multiplier;j++)magnitude+=freqByteData[offset+j];magnitude=magnitude/multiplier;var magnitude2=freqByteData[i*multiplier];if(attrs.waveColor)analyserContext.fillStyle=
attrs.waveColor;else analyserContext.fillStyle="hsl( "+Math.round(i*360/numBars)+", 100%, 50%)";analyserContext.fillRect(i*SPACING,canvasHeight,BAR_WIDTH,-magnitude)}}rafID=window.requestAnimationFrame(updateAnalysers)}function cancelAnalyserUpdates(){window.cancelAnimationFrame(rafID);rafID=null}element.on("$destroy",function(){cancelAnalyserUpdates()});recorder.onRecordStart=function(original){return function(){original.apply();updateAnalysers()}}(recorder.onRecordStart);utils.appendActionToCallback(recorder,
"onRecordStart",updateAnalysers,"analyzer");utils.appendActionToCallback(recorder,"onRecordComplete",cancelAnalyserUpdates,"analyzer")};return{restrict:"E",require:"^ngAudioRecorder",template:'<div ng-if="!hide" class="audioRecorder-analyzer">'+'<canvas class="analyzer" width="1200" height="400" style="max-width: 100%;"></canvas>'+"</div>",link:link}}]);angular.module("angularAudioRecorder.directives").directive("ngAudioRecorderWaveView",["recorderService","recorderUtils","$log",function(service,
utils,$log){return{restrict:"E",require:"^ngAudioRecorder",link:function(scope,$element,attrs,recorder){if(!window.WaveSurfer){$log.warn("WaveSurfer was found.");return}var audioPlayer;$element.html('<div class="waveSurfer"></div>');var options=angular.extend({container:$element.find("div")[0]},attrs);var waveSurfer=WaveSurfer.create(options);waveSurfer.setVolume(0);utils.appendActionToCallback(recorder,"onPlaybackStart|onPlaybackResume",function(){waveSurfer.play()},"waveView");utils.appendActionToCallback(recorder,
"onPlaybackComplete|onPlaybackPause",function(){waveSurfer.pause()},"waveView");utils.appendActionToCallback(recorder,"onRecordComplete",function(){if(!audioPlayer){audioPlayer=recorder.getAudioPlayer();audioPlayer.addEventListener("seeking",function(e){var progress=audioPlayer.currentTime/audioPlayer.duration;waveSurfer.seekTo(progress)})}},"waveView");scope.$watch(function(){return recorder.audioModel},function(newBlob){if(newBlob instanceof Blob)waveSurfer.loadBlob(newBlob)})}}}]);angular.module("angularAudioRecorder.directives").directive("ngAudioRecorder",
["recorderService","$timeout",function(recorderService,$timeout){return{restrict:"EA",scope:{audioModel:"=",id:"@",onRecordStart:"&",onRecordComplete:"&",onPlaybackComplete:"&",onPlaybackStart:"&",onPlaybackPause:"&",onPlaybackResume:"&",onConversionStart:"&",onConversionComplete:"&",showPlayer:"=?",autoStart:"=?",convertMp3:"=?",timeLimit:"=?",buttonStatus:"=?",currentCourseUrl:"=?",currentScreenId:"=?",src:"=?"},controllerAs:"recorder",bindToController:true,template:function(element,attrs){return'<div class="audioRecorder">'+
'<div style="width: 250px; margin: 0 auto;"><div id="audioRecorder-fwrecorder"></div></div>'+element.html()+"</div>"},controller:"recorderController",link:function(scope,element,attrs){$timeout(function(){if(recorderService.isAvailable&&!(recorderService.isHtml5||recorderService.isCordova)){var params={"allowscriptaccess":"always"},attrs={"id":"recorder-app","name":"recorder-app"},flashVars={"save_text":""};swfobject.embedSWF(recorderService.getSwfUrl(),"audioRecorder-fwrecorder","0","0","11.0.0",
"",flashVars,params,attrs)}},100)}}}]);angular.module("angularAudioRecorder.services",["angularAudioRecorder.config"]);angular.module("angularAudioRecorder.services").provider("recorderService",["recorderScriptUrl",function(scriptPath){var handler=null,service={isHtml5:false,isReady:false},permissionHandlers={onDenied:null,onClosed:null,onAllow:null},forceSwf=false,swfUrl=scriptPath+"recorder.swf",utils,mp3Covert=false,mp3Config={bitRate:92,lameJsUrl:scriptPath+"lame.all.js"};var swfHandlerConfig=
{isAvailable:false,loaded:false,configureMic:function(){if(!FWRecorder.isReady)return;FWRecorder.configure(44,100,0,2E3);FWRecorder.setUseEchoSuppression(false);FWRecorder.setLoopBack(false)},allowed:false,externalEvents:function(eventName){var name=arguments[1];switch(arguments[0]){case "ready":var width=parseInt(arguments[1]);var height=parseInt(arguments[2]);FWRecorder.connect("recorder-app",0);FWRecorder.recorderOriginalWidth=1;FWRecorder.recorderOriginalHeight=1;swfHandlerConfig.loaded=true;
break;case "microphone_user_request":FWRecorder.showPermissionWindow({permanent:true});break;case "microphone_connected":console.log("Permission to use MIC granted");swfHandlerConfig.allowed=true;break;case "microphone_not_connected":console.log("Permission to use MIC denied");swfHandlerConfig.allowed=false;break;case "permission_panel_closed":if(swfHandlerConfig.allowed)swfHandlerConfig.setAllowed();else swfHandlerConfig.setDeclined();FWRecorder.defaultSize();if(angular.isFunction(permissionHandlers.onClosed))permissionHandlers.onClosed();
break;case "recording":FWRecorder.hide();break;case "recording_stopped":FWRecorder.hide();break;case "playing":break;case "playback_started":var latency=arguments[2];break;case "save_pressed":FWRecorder.updateForm();break;case "saving":break;case "saved":var data=$.parseJSON(arguments[2]);if(data.saved);else;break;case "save_failed":var errorMessage=arguments[2];break;case "save_progress":var bytesLoaded=arguments[2];var bytesTotal=arguments[3];break;case "stopped":case "playing_paused":case "no_microphone_found":case "observing_level":case "microphone_level":case "microphone_activity":case "observing_level_stopped":default:break}},
isInstalled:function(){return swfobject.getFlashPlayerVersion().major>0},init:function(){service.isHtml5=false;if(!swfHandlerConfig.isInstalled()){console.log("Flash is not installed, application cannot be initialized");return}swfHandlerConfig.isAvailable=true;window.fwr_event_handler=swfHandlerConfig.externalEvents;window.configureMicrophone=swfHandlerConfig.configureMic},setAllowed:function(){service.isReady=true;handler=FWRecorder;if(angular.isFunction(permissionHandlers.onAllowed))permissionHandlers.onAllowed()},
setDeclined:function(){service.isReady=false;handler=null;if(angular.isFunction(permissionHandlers.onDenied))permissionHandlers.onDenied()},getPermission:function(){if(swfHandlerConfig.isAvailable)if(!FWRecorder.isMicrophoneAccessible())FWRecorder.showPermissionWindow({permanent:true});else{swfHandlerConfig.allowed=true;setTimeout(function(){swfHandlerConfig.setAllowed()},100)}}};var html5AudioProps={audioContext:null,inputPoint:null,audioInput:null,audioRecorder:null,analyserNode:null};var html5HandlerConfig=
{gotStream:function(stream){var audioContext=html5AudioProps.audioContext;html5AudioProps.audioInput=audioContext.createMediaStreamSource(stream);html5AudioProps.audioInput.connect(html5AudioProps.inputPoint=audioContext.createGain());html5AudioProps.analyserNode=audioContext.createAnalyser();html5AudioProps.analyserNode.fftSize=2048;html5AudioProps.inputPoint.connect(html5AudioProps.analyserNode);html5AudioProps.audioRecorder=new Recorder(html5AudioProps.audioInput);var zeroGain=audioContext.createGain();
zeroGain.gain.value=0;html5AudioProps.inputPoint.connect(zeroGain);zeroGain.connect(audioContext.destination);service.isReady=true;handler=html5AudioProps.audioRecorder;if(angular.isFunction(permissionHandlers.onAllowed)){if(window.location.protocol=="https:")localStorage.setItem("permission","given");permissionHandlers.onAllowed()}},failStream:function(data){if(angular.isDefined(permissionHandlers.onDenied))permissionHandlers.onDenied()},getPermission:function(){console.log("per");navigator.getUserMedia({"audio":true},
html5HandlerConfig.gotStream,html5HandlerConfig.failStream)},init:function(){service.isHtml5=true;var AudioContext=window.AudioContext||window.webkitAudioContext;if(AudioContext&&!html5AudioProps.audioContext){html5AudioProps.audioContext=new AudioContext;console.log("in init")}if(localStorage.getItem("permission")!==null){console.log("getPer");html5HandlerConfig.getPermission()}}};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;service.isCordova=
false;var init=function(){console.log("AS");if("cordova"in window)service.isCordova=true;else if(!forceSwf&&navigator.getUserMedia){console.log("init");html5HandlerConfig.init()}else swfHandlerConfig.init()};var controllers={};service.controller=function(id){return controllers[id]};service.getSwfUrl=function(){return swfUrl};service.setController=function(id,controller){controllers[id]=controller};service.isAvailable=function(){if(service.isCordova){if(!("Media"in window))throw new Error('The Media plugin for cordova is required for this library, add plugin using "cordova plugin add cordova-plugin-media"');
return true}return service.isHtml5||swfHandlerConfig.isInstalled()};service.getHandler=function(){return handler};service.showPermission=function(listeners){if(!service.isAvailable()){console.warn("Neither HTML5 nor SWF is supported.");return}if(listeners)angular.extend(permissionHandlers,listeners);if(service.isHtml5)html5HandlerConfig.getPermission();else swfHandlerConfig.getPermission()};service.swfIsLoaded=function(){return swfHandlerConfig.loaded};service.shouldConvertToMp3=function(){return mp3Covert};
service.getMp3Config=function(){return mp3Config};service.$html5AudioProps=html5AudioProps;var provider={$get:["recorderUtils",function(recorderUtils){utils=recorderUtils;init();return service}],forceSwf:function(value){forceSwf=value;return provider},setSwfUrl:function(path){swfUrl=path;return provider},withMp3Conversion:function(bool,config){mp3Covert=!!bool;mp3Config=angular.extend(mp3Config,config||{});return provider}};return provider}]);angular.module("angularAudioRecorder.services").factory("recorderUtils",
[function(){var factory={generateUuid:function(){function _p8(s){var p=(Math.random().toString(16)+"000000000").substr(2,8);return s?"-"+p.substr(0,4)+"-"+p.substr(4,4):p}return _p8()+_p8(true)+_p8(true)+_p8()},cordovaAudioUrl:function(id){if(!window.cordova)return"record-audio"+id+".wav";var url=cordova.file.tempDirectory||cordova.file.externalApplicationStorageDirectory||cordova.file.sharedDirectory;url+=Date.now()+"_recordedAudio_"+id.replace("/[^A-Za-z0-9_-]+/gi","-");switch(window.cordova.platformId){case "ios":url+=
".wav";break;case "android":url+=".amr";break;case "wp":url+=".wma";break;default:url+=".mp3"}return url}};factory.appendActionToCallback=function(object,callbacks,action,track){callbacks.split(/\|/).forEach(function(callback){if(!angular.isObject(object)||!angular.isFunction(action)||!(callback in object)||!angular.isFunction(object[callback]))throw new Error("One or more parameter supplied is not valid");if(!("$$appendTrackers"in object))object.$$appendTrackers=[];var tracker=callback+"|"+track;
if(object.$$appendTrackers.indexOf(tracker)>-1){console.log("Already appended: ",tracker);return}object[callback]=function(original){return function(){original.apply(object,arguments);action.apply(object,arguments)}}(object[callback]);object.$$appendTrackers.push(tracker)})};return factory}])})();
(function(global){var Recorder,RECORDED_AUDIO_TYPE="audio/wav";Recorder={recorder:null,recorderOriginalWidth:0,recorderOriginalHeight:0,uploadFormId:null,uploadFieldName:null,isReady:false,connect:function(name,attempts){if(navigator.appName.indexOf("Microsoft")!=-1)Recorder.recorder=window[name];else Recorder.recorder=document[name];if(attempts>=40)return;if(Recorder.recorder&&Recorder.recorder.init){Recorder.recorderOriginalWidth=Recorder.recorder.width;Recorder.recorderOriginalHeight=Recorder.recorder.height;
if(Recorder.uploadFormId&&$){var frm=$(Recorder.uploadFormId);Recorder.recorder.init(frm.attr("action").toString(),Recorder.uploadFieldName,frm.serializeArray())}return}setTimeout(function(){Recorder.connect(name,attempts+1)},100)},playBack:function(name){Recorder.recorder.playBack(name)},pausePlayBack:function(name){Recorder.recorder.pausePlayBack(name)},playBackFrom:function(name,time){Recorder.recorder.playBackFrom(name,time)},record:function(name,filename){Recorder.recorder.record(name,filename)},
stopRecording:function(){Recorder.recorder.stopRecording()},stopPlayBack:function(){Recorder.recorder.stopPlayBack()},observeLevel:function(){Recorder.recorder.observeLevel()},stopObservingLevel:function(){Recorder.recorder.stopObservingLevel()},observeSamples:function(){Recorder.recorder.observeSamples()},stopObservingSamples:function(){Recorder.recorder.stopObservingSamples()},resize:function(width,height){Recorder.recorder.width=width+"px";Recorder.recorder.height=height+"px"},defaultSize:function(){Recorder.resize(Recorder.recorderOriginalWidth,
Recorder.recorderOriginalHeight)},show:function(){Recorder.recorder.show()},hide:function(){Recorder.recorder.hide()},duration:function(name){return Recorder.recorder.duration(name||Recorder.uploadFieldName)},getBase64:function(name){var data=Recorder.recorder.getBase64(name);return"data:"+RECORDED_AUDIO_TYPE+";base64,"+data},getBlob:function(name){var base64Data=Recorder.getBase64(name).split(",")[1];return base64toBlob(base64Data,RECORDED_AUDIO_TYPE)},getCurrentTime:function(name){return Recorder.recorder.getCurrentTime(name)},
isMicrophoneAccessible:function(){return Recorder.recorder.isMicrophoneAccessible()},updateForm:function(){var frm=$(Recorder.uploadFormId);Recorder.recorder.update(frm.serializeArray())},showPermissionWindow:function(options){Recorder.resize(240,160);var permissionCommand=function(){if(options&&options.permanent)Recorder.recorder.permitPermanently();else Recorder.recorder.permit()};setTimeout(permissionCommand,1)},configure:function(rate,gain,silenceLevel,silenceTimeout){rate=parseInt(rate||22);
gain=parseInt(gain||100);silenceLevel=parseInt(silenceLevel||0);silenceTimeout=parseInt(silenceTimeout||4E3);switch(rate){case 44:case 22:case 11:case 8:case 5:break;default:throw"invalid rate "+rate;}if(gain<0||gain>100)throw"invalid gain "+gain;if(silenceLevel<0||silenceLevel>100)throw"invalid silenceLevel "+silenceLevel;if(silenceTimeout<-1)throw"invalid silenceTimeout "+silenceTimeout;Recorder.recorder.configure(rate,gain,silenceLevel,silenceTimeout)},setUseEchoSuppression:function(val){if(typeof val!=
"boolean")throw"invalid value for setting echo suppression, val: "+val;Recorder.recorder.setUseEchoSuppression(val)},setLoopBack:function(val){if(typeof val!="boolean")throw"invalid value for setting loop back, val: "+val;Recorder.recorder.setLoopBack(val)}};function base64toBlob(b64Data,contentType,sliceSize){contentType=contentType||"";sliceSize=sliceSize||512;var byteCharacters=atob(b64Data);var byteArrays=[];for(var offset=0;offset<byteCharacters.length;offset+=sliceSize){var slice=byteCharacters.slice(offset,
offset+sliceSize);var byteNumbers=new Array(slice.length);for(var i=0;i<slice.length;i++)byteNumbers[i]=slice.charCodeAt(i);var byteArray=new Uint8Array(byteNumbers);byteArrays.push(byteArray)}return new Blob(byteArrays,{type:contentType})}global.FWRecorder=Recorder})(window);
(function(){var workerToBlobUrl=function(fn,params){if(typeof fn!=="function")throw"The specified parameter must be a valid function";var fnString=fn.toString();if(fnString.match(/\[native\s*code\]/i))throw"You cannot bind a native function to a worker";params=params||{};if(typeof params!=="object")console.warn("Params must be an object that is serializable with JSON.stringify, specified is: "+typeof params);var blobURL=window.URL.createObjectURL(new Blob(["(",fnString,")(this,",JSON.stringify(params),
")"],{type:"application/javascript"}));return blobURL};Function.prototype.toWorker=function(params){var url=workerToBlobUrl(this,params);return new Worker(url)}})();
(function(win){var RecorderWorker=function(me){var recLength=0,recBuffersL=[],recBuffersR=[],bits=16,sampleRate;me.onmessage=function(e){switch(e.data.command){case "init":init(e.data.config);break;case "record":record(e.data.buffer);break;case "exportWAV":exportWAV(e.data.type);break;case "getBuffer":getBuffer();break;case "clear":clear();break}};function init(config){sampleRate=config.sampleRate}function record(inputBuffer){recBuffersL.push(inputBuffer[0]);recLength+=inputBuffer[0].length}function exportWAV(type){var bufferL=
mergeBuffers(recBuffersL,recLength);var dataview=encodeWAV(bufferL);var audioBlob=new Blob([dataview],{type:type});me.postMessage(audioBlob)}function getBuffer(){var buffers=[];buffers.push(mergeBuffers(recBuffersL,recLength));buffers.push(mergeBuffers(recBuffersR,recLength));me.postMessage(buffers)}function clear(){recLength=0;recBuffersL=[];recBuffersR=[]}function mergeBuffers(recBuffers,recLength){var result=new Float32Array(recLength);var offset=0;for(var i=0;i<recBuffers.length;i++){result.set(recBuffers[i],
offset);offset+=recBuffers[i].length}return result}function floatTo16BitPCM(output,offset,input){for(var i=0;i<input.length;i++,offset+=2){var s=Math.max(-1,Math.min(1,input[i]));output.setInt16(offset,s<0?s*32768:s*32767,true)}}function writeString(view,offset,string){for(var i=0;i<string.length;i++)view.setUint8(offset+i,string.charCodeAt(i))}function encodeWAV(samples){var buffer=new ArrayBuffer(44+samples.length*2);var view=new DataView(buffer);writeString(view,0,"RIFF");view.setUint32(4,32+samples.length*
2,true);writeString(view,8,"WAVE");writeString(view,12,"fmt ");view.setUint32(16,16,true);view.setUint16(20,1,true);view.setUint16(22,1,true);view.setUint32(24,sampleRate,true);view.setUint32(28,sampleRate*2,true);view.setUint16(32,2,true);view.setUint16(34,16,true);writeString(view,36,"data");view.setUint32(40,samples.length*2,true);floatTo16BitPCM(view,44,samples);return view}};var Recorder=function(source,cfg){var config=cfg||{};var bufferLen=config.bufferLen||4096;this.context=source.context;
this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,bufferLen,2,2);var worker=RecorderWorker.toWorker();worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}});var recording=false,currCallback;this.node.onaudioprocess=function(e){if(!recording)return;worker.postMessage({command:"record",buffer:[e.inputBuffer.getChannelData(0)]})};this.configure=function(cfg){for(var prop in cfg)if(cfg.hasOwnProperty(prop))config[prop]=cfg[prop]};
this.record=function(){recording=true};this.stop=function(){recording=false};this.clear=function(){worker.postMessage({command:"clear"})};this.getBuffer=function(cb){currCallback=cb||config.callback;worker.postMessage({command:"getBuffer"})};this.exportWAV=function(cb,type){currCallback=cb||config.callback;type=type||config.type||"audio/wav";if(!currCallback)throw new Error("Callback not set");worker.postMessage({command:"exportWAV",type:type})};worker.onmessage=function(e){var blob=e.data;currCallback(blob)};
source.connect(this.node);this.node.connect(this.context.destination)};win.Recorder=Recorder})(window);
(function(win){var MP3ConversionWorker=function(me,params){console.log("MP3 conversion worker started.");if(typeof lamejs==="undefined")importScripts(params.lameJsUrl);var mp3Encoder,maxSamples=1152,wav,samples,lame,config,dataBuffer;var clearBuffer=function(){dataBuffer=[]};var appendToBuffer=function(mp3Buf){dataBuffer.push(new Int8Array(mp3Buf))};var init=function(prefConfig){config=prefConfig||{};lame=new lamejs;clearBuffer()};var encode=function(arrayBuffer){wav=lame.__proto__.constructor.WavHeader.readHeader(new DataView(arrayBuffer));
console.log("wave:",wav);samples=new Int16Array(arrayBuffer,wav.dataOffset,wav.dataLen/2);mp3Encoder=new lame.__proto__.constructor.Mp3Encoder(wav.channels,wav.sampleRate,config.bitRate||128);var remaining=samples.length;for(var i=0;remaining>=maxSamples;i+=maxSamples){var mono=samples.subarray(i,i+maxSamples);var mp3buf=mp3Encoder.encodeBuffer(mono);appendToBuffer(mp3buf);remaining-=maxSamples}};var finish=function(){var mp3buf=mp3Encoder.flush();appendToBuffer(mp3buf);self.postMessage({cmd:"end",
buf:dataBuffer});console.log("done encoding");clearBuffer()};me.onmessage=function(e){switch(e.data.cmd){case "init":init(e.data.config);break;case "encode":encode(e.data.rawInput);break;case "finish":finish();break}}};var SCRIPT_BASE=function(){var scripts=document.getElementsByTagName("script");var myUrl=scripts[scripts.length-1].getAttribute("src");var path=myUrl.substr(0,myUrl.lastIndexOf("/")+1);if(path&&!path.match(/:\/\//)){var a=document.createElement("a");a.href=path;return a.href}return path}();
var MP3Converter=function(config){config=config||{};config.lameJsUrl=config.lameJsUrl||SCRIPT_BASE+"lame.all.js";var busy=false;var mp3Worker=MP3ConversionWorker.toWorker(config);this.isBusy=function(){return busy};this.convert=function(blob){var conversionId="conversion_"+Date.now(),tag=conversionId+":";console.log(tag,"Starting conversion");var preferredConfig={},onSuccess,onError;switch(typeof arguments[1]){case "object":preferredConfig=arguments[1];break;case "function":onSuccess=arguments[1];
break;default:throw"parameter 2 is expected to be an object (config) or function (success callback)";}if(typeof arguments[2]==="function")if(onSuccess)onError=arguments[2];else onSuccess=arguments[2];if(typeof arguments[3]==="function"&&!onError)onError=arguments[3];if(busy)throw"Another conversion is in progress";var initialSize=blob.size,fileReader=new FileReader,startTime=Date.now();fileReader.onload=function(e){console.log(tag,"Passed to BG process");mp3Worker.postMessage({cmd:"init",config:preferredConfig});
mp3Worker.postMessage({cmd:"encode",rawInput:e.target.result});mp3Worker.postMessage({cmd:"finish"});mp3Worker.onmessage=function(e){if(e.data.cmd=="end"){console.log(tag,"Done converting to Mp3");var mp3Blob=new Blob(e.data.buf,{type:"audio/mp3"});console.log(tag,"Conversion completed in: "+(Date.now()-startTime)/1E3+"s");var finalSize=mp3Blob.size;console.log(tag+"Initial size: = "+initialSize+", "+"Final size = "+finalSize+", Reduction: "+Number(100*(initialSize-finalSize)/initialSize).toPrecision(4)+
"%");busy=false;if(onSuccess&&typeof onSuccess==="function")onSuccess(mp3Blob)}}};busy=true;fileReader.readAsArrayBuffer(blob)}};win.MP3Converter=MP3Converter})(window);
(function(win){win.swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",win=window,doc=document,nav=navigator,domLoadFnArr=[],regObjArr=[],objIdArr=[],listenersArr=[],script,timer=null,storedAltContent=null,storedAltContentId=null,isDomLoaded=false,isExpressInstallActive=false;var ua=function(){var w3cdom=typeof doc.getElementById!=
UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);
playerVersion[2]=/r/.test(d)?parseInt(d.replace(/^.*r(.*)$/,"$1"),10):0}}else if(typeof win.ActiveXObject!=UNDEF){var a=null,fp6Crash=false;try{a=new ActiveXObject(SHOCKWAVE_FLASH_AX+".7")}catch(e$1){try{a=new ActiveXObject(SHOCKWAVE_FLASH_AX+".6");playerVersion=[6,0,21];a.AllowScriptAccess="always"}catch(e){if(playerVersion[0]==6)fp6Crash=true}if(!fp6Crash)try{a=new ActiveXObject(SHOCKWAVE_FLASH_AX)}catch(e$0){}}if(!fp6Crash&&a)try{d=a.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");playerVersion=
[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)]}}catch(e$2){}}var u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ie=false,windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u);return{w3cdom:w3cdom,pv:playerVersion,webkit:webkit,ie:ie,win:windows,mac:mac}}();var onDomLoad=function(){if(!ua.w3cdom)return;addDomLoadEvent(main);if(ua.ie&&ua.win)try{doc.write("<scr"+"ipt id=__ie_ondomload defer=true src=//:></scr"+
"ipt>");script=getElementById("__ie_ondomload");if(script)addListener(script,"onreadystatechange",checkReadyState)}catch(e){}if(ua.webkit&&typeof doc.readyState!=UNDEF)timer=setInterval(function(){if(/loaded|complete/.test(doc.readyState))callDomLoadFunctions()},10);if(typeof doc.addEventListener!=UNDEF)doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,null);addLoadEvent(callDomLoadFunctions)}();function checkReadyState(){if(script.readyState=="complete"){script.parentNode.removeChild(script);
callDomLoadFunctions()}}function callDomLoadFunctions(){if(isDomLoaded)return;if(ua.ie&&ua.win){var s=createElement("span");try{var t=doc.getElementsByTagName("body")[0].appendChild(s);t.parentNode.removeChild(t)}catch(e){return}}isDomLoaded=true;if(timer){clearInterval(timer);timer=null}var dl=domLoadFnArr.length;for(var i=0;i<dl;i++)domLoadFnArr[i]()}function addDomLoadEvent(fn){if(isDomLoaded)fn();else domLoadFnArr[domLoadFnArr.length]=fn}function addLoadEvent(fn){if(typeof win.addEventListener!=
UNDEF)win.addEventListener("load",fn,false);else if(typeof doc.addEventListener!=UNDEF)doc.addEventListener("load",fn,false);else if(typeof win.attachEvent!=UNDEF)addListener(win,"onload",fn);else if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn()}}else win.onload=fn}function main(){var rl=regObjArr.length;for(var i=0;i<rl;i++){var id=regObjArr[i].id;if(ua.pv[0]>0){var obj=getElementById(id);if(obj){regObjArr[i].width=obj.getAttribute("width")?obj.getAttribute("width"):
"0";regObjArr[i].height=obj.getAttribute("height")?obj.getAttribute("height"):"0";if(hasPlayerVersion(regObjArr[i].swfVersion)){if(ua.webkit&&ua.webkit<312)fixParams(obj);setVisibility(id,true)}else if(regObjArr[i].expressInstall&&!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac))showExpressInstall(regObjArr[i]);else displayAltContent(obj)}}else setVisibility(id,true)}}function fixParams(obj){var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var e=createElement("embed"),
a=nestedObj.attributes;if(a){var al=a.length;for(var i=0;i<al;i++)if(a[i].nodeName=="DATA")e.setAttribute("src",a[i].nodeValue);else e.setAttribute(a[i].nodeName,a[i].nodeValue)}var c=nestedObj.childNodes;if(c){var cl=c.length;for(var j=0;j<cl;j++)if(c[j].nodeType==1&&c[j].nodeName=="PARAM")e.setAttribute(c[j].getAttribute("name"),c[j].getAttribute("value"))}obj.parentNode.replaceChild(e,obj)}}function showExpressInstall(regObj){isExpressInstallActive=true;var obj=getElementById(regObj.id);if(obj){if(regObj.altContentId){var ac=
getElementById(regObj.altContentId);if(ac){storedAltContent=ac;storedAltContentId=regObj.altContentId}}else storedAltContent=abstractAltContent(obj);if(!/%$/.test(regObj.width)&&parseInt(regObj.width,10)<310)regObj.width="310";if(!/%$/.test(regObj.height)&&parseInt(regObj.height,10)<137)regObj.height="137";doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",dt=doc.title,fv="MMredirectURL="+win.location+"&MMplayerType="+pt+"&MMdoctitle="+dt,replaceId=
regObj.id;if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceId+="SWFObjectNew";newObj.setAttribute("id",replaceId);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";var fn=function(){obj.parentNode.removeChild(obj)};addListener(win,"onload",fn)}createSWF({data:regObj.expressInstall,id:EXPRESS_INSTALL_ID,width:regObj.width,height:regObj.height},{flashvars:fv},replaceId)}}function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");
obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";var fn=function(){obj.parentNode.removeChild(obj)};addListener(win,"onload",fn)}else obj.parentNode.replaceChild(abstractAltContent(obj),obj)}function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie)ac.innerHTML=obj.innerHTML;else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++)if(!(c[i].nodeType==
1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8))ac.appendChild(c[i].cloneNode(true))}}}return ac}function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(el){if(typeof attObj.id==UNDEF)attObj.id=id;if(ua.ie&&ua.win){var att="";for(var i in attObj)if(attObj[i]!=Object.prototype[i])if(i.toLowerCase()=="data")parObj.movie=attObj[i];else if(i.toLowerCase()=="styleclass")att+=' class="'+attObj[i]+'"';else if(i.toLowerCase()!="classid")att+=" "+i+'="'+attObj[i]+'"';var par="";for(var j in parObj)if(parObj[j]!=
Object.prototype[j])par+='<param name="'+j+'" value="'+parObj[j]+'" />';el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+">"+par+"</object>";objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id)}else if(ua.webkit&&ua.webkit<312){var e=createElement("embed");e.setAttribute("type",FLASH_MIME_TYPE);for(var k in attObj)if(attObj[k]!=Object.prototype[k])if(k.toLowerCase()=="data")e.setAttribute("src",attObj[k]);else if(k.toLowerCase()=="styleclass")e.setAttribute("class",
attObj[k]);else if(k.toLowerCase()!="classid")e.setAttribute(k,attObj[k]);for(var l in parObj)if(parObj[l]!=Object.prototype[l])if(l.toLowerCase()!="movie")e.setAttribute(l,parObj[l]);el.parentNode.replaceChild(e,el);r=e}else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj)if(attObj[m]!=Object.prototype[m])if(m.toLowerCase()=="styleclass")o.setAttribute("class",attObj[m]);else if(m.toLowerCase()!="classid")o.setAttribute(m,attObj[m]);for(var n in parObj)if(parObj[n]!=
Object.prototype[n]&&n.toLowerCase()!="movie")createObjParam(o,n,parObj[n]);el.parentNode.replaceChild(o,el);r=o}}return r}function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p)}function removeSWF(id){var obj=getElementById(id);if(obj&&(obj.nodeName=="OBJECT"||obj.nodeName=="EMBED"))if(ua.ie&&ua.win)if(obj.readyState==4)removeObjectInIE(id);else win.attachEvent("onload",function(){removeObjectInIE(id)});else obj.parentNode.removeChild(obj)}
function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj)if(typeof obj[i]=="function")obj[i]=null;obj.parentNode.removeChild(obj)}}function getElementById(id){var el=null;try{el=doc.getElementById(id)}catch(e){}return el}function createElement(el){return doc.createElement(el)}function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn]}function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],
10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return pv[0]>v[0]||pv[0]==v[0]&&pv[1]>v[1]||pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]?true:false}function createCSS(sel,decl){if(ua.ie&&ua.mac)return;var h=doc.getElementsByTagName("head")[0],s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media","screen");if(!(ua.ie&&ua.win)&&typeof doc.createTextNode!=UNDEF)s.appendChild(doc.createTextNode(sel+" {"+decl+"}"));h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=
UNDEF&&doc.styleSheets.length>0){var ls=doc.styleSheets[doc.styleSheets.length-1];if(typeof ls.addRule==OBJECT)ls.addRule(sel,decl)}}function setVisibility(id,isVisible){var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id))getElementById(id).style.visibility=v;else createCSS("#"+id,"visibility:"+v)}function urlEncodeIfNecessary(s){var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars?encodeURIComponent(s):s}var cleanup=function(){if(ua.ie&&ua.win)window.attachEvent("onunload",
function(){var ll=listenersArr.length;for(var i=0;i<ll;i++)listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2]);var il=objIdArr.length;for(var j=0;j<il;j++)removeSWF(objIdArr[j]);for(var k in ua)ua[k]=null;ua=null;for(var l in swfobject)swfobject[l]=null;swfobject=null})}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr){if(!ua.w3cdom||!objectIdStr||!swfVersionStr)return;var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=
xiSwfUrlStr?xiSwfUrlStr:false;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,false)},getObjectById:function(objectIdStr){var r=null;if(ua.w3cdom){var o=getElementById(objectIdStr);if(o){var n=o.getElementsByTagName(OBJECT)[0];if(!n||n&&typeof o.SetVariable!=UNDEF)r=o;else if(typeof n.SetVariable!=UNDEF)r=n}}return r},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj){if(!ua.w3cdom||!swfUrlStr||!replaceElemIdStr||!widthStr||
!heightStr||!swfVersionStr)return;widthStr+="";heightStr+="";if(hasPlayerVersion(swfVersionStr)){setVisibility(replaceElemIdStr,false);var att={};if(attObj&&typeof attObj===OBJECT)for(var i in attObj)if(attObj[i]!=Object.prototype[i])att[i]=attObj[i];att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT)for(var j in parObj)if(parObj[j]!=Object.prototype[j])par[j]=parObj[j];if(flashvarsObj&&typeof flashvarsObj===OBJECT)for(var k in flashvarsObj)if(flashvarsObj[k]!=
Object.prototype[k])if(typeof par.flashvars!=UNDEF)par.flashvars+="&"+k+"="+flashvarsObj[k];else par.flashvars=k+"="+flashvarsObj[k];addDomLoadEvent(function(){createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr)setVisibility(replaceElemIdStr,true)})}else if(xiSwfUrlStr&&!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)){isExpressInstallActive=true;setVisibility(replaceElemIdStr,false);addDomLoadEvent(function(){var regObj={};regObj.id=regObj.altContentId=replaceElemIdStr;
regObj.width=widthStr;regObj.height=heightStr;regObj.expressInstall=xiSwfUrlStr;showExpressInstall(regObj)})}},getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]}},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3cdom)return createSWF(attObj,parObj,replaceElemIdStr);else return undefined},removeSWF:function(objElemIdStr){if(ua.w3cdom)removeSWF(objElemIdStr)},createCSS:function(sel,decl){if(ua.w3cdom)createCSS(sel,
decl)},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(param==null)return urlEncodeIfNecessary(q);if(q){var pairs=q.substring(1).split("&");for(var i=0;i<pairs.length;i++)if(pairs[i].substring(0,pairs[i].indexOf("="))==param)return urlEncodeIfNecessary(pairs[i].substring(pairs[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(isExpressInstallActive&&storedAltContent){var obj=getElementById(EXPRESS_INSTALL_ID);
if(obj){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,true);if(ua.ie&&ua.win)storedAltContent.style.display="block"}storedAltContent=null;storedAltContentId=null;isExpressInstallActive=false}}}}}()})(window);(function(ng){angular.module("audioRecord",[]).directive("audioRecord",[function(){return{restrict:"E",scope:{src:"="},replace:true,templateUrl:"/static/templates/content/elements/audio-record.html",controller:["$scope","$compile","$window","$rootScope","$http",function($scope,$compile,$window,$rootScope,$http){console.log("audio-record....."+$scope.src);$scope.timeLimit=300;$scope.currentCourseUrl=$rootScope.currentCourseUrl;$scope.currentScreenId=$rootScope.currentScreenId;$scope.screenWidth=$("#screen").width();
angular.element($window).bind("scroll",function(){var for_offset=$("#for_offset");var buttons_container=$("#buttons_container");var window_offset=for_offset.offset().top-$(window).scrollTop();if(window_offset<0)buttons_container.css({"position":"fixed","width":$scope.screenWidth-22,"z-index":"9999"});else buttons_container.css({"position":"relative","width":"100%","z-index":"100"})})}]}}])})(angular);(function(ng){angular.module("codeBox",[]).directive("codeBox",[function(){return{restirct:"E",scope:{data:"="},replace:true,templateUrl:"/static/templates/content/elements/code-box.html",controller:["$scope","$rootScope","$http","$sce","$timeout",function($scope,$rootScope,$http,$sce,$timeout){console.log("Code box");console.log($scope.data);$rootScope.codeMirrorOptions={};$scope.codeBoxOptions=$scope.data.codeBoxOptions;$scope.codeBoxPreferences={theme:"default",font:"normal",technology:JSON.stringify($scope.data.technology)};
$scope.currentTechnology=$scope.data.technology;console.log($scope.data.technology);$scope.tabs=[{active:true},{active:false},{active:false}];if($scope.data!==null)$rootScope.defaultSampleCode=angular.copy($scope.data.sample_code);else $scope.showSolution=false;$scope.getLocalStoragePreferencesForCodeBox=function(){if(localStorage.getItem("codeBoxPref")){$scope.codeBoxPreferences=JSON.parse(localStorage.getItem("codeBoxPref"));$scope.codeBoxOptions.theme=$scope.codeBoxPreferences.theme;if(!$scope.data.technology)$scope.data.technology=
$scope.currentTechnology=JSON.parse($scope.codeBoxPreferences.technology)}};if(!$scope.codeBoxOptions.isCodeChallenge)$scope.getLocalStoragePreferencesForCodeBox();$rootScope.refreshCodeMirror=function(){$rootScope.refreshCodemirror=false;$timeout(function(){$rootScope.refreshCodemirror=true},500)};$rootScope.changeMode=function(mode){switch(mode){case "html":mode="application/x-httpd-php";break;case "kotlin":mode="text/x-kotlin";break;case "java":moded="text/x-java";case "php":mode="application/x-httpd-php";
break;case "default":mode="application/x-httpd-php";break}if(mode){$scope.codeBoxOptions.mode=mode;$rootScope.codeMirrorOptions.mode=mode}$rootScope.refreshCodeMirror()};$rootScope.changeMode($scope.currentTechnology.compiler);$rootScope.codeMirrorOptions={styleActiveLine:true,lineNumbers:true,lineWrapping:true,matchBrackets:true,theme:$scope.codeBoxOptions.theme,indentUnit:4,mode:$scope.codeBoxOptions.mode,autoCloseTags:true,autoCloseBrackets:true,readonly:true,gutters:["CodeMirror-lint-markers"],
lint:true,onLoad:function(_cm){$scope.modeChanged=function(){_cm.setOption("mode",$scope.mode.toLowerCase())};$scope.applyLocalStoragePreferencesToCodeBox();$rootScope.refreshCodeMirror();$scope.addResizeEventsToCodeBox();$scope.resetCodeBoxDimensions();if(!$scope.codeBoxOptions.isCodeChallenge){var windowHeight=$(window).height();$("#code_editor").height(windowHeight-125);$("#output_container").height(windowHeight-125);$(".CodeMirror").height(windowHeight-125-92);$(".output_screen").height($("#output_container").height()-
44)}},extraKeys:{"F11":function(cm){cm.setOption("fullScreen",!cm.getOption("fullScreen"))},"Esc":function(cm){if(cm.getOption("fullScreen"))cm.setOption("fullScreen",false)}}};$scope.addResizeEventsToCodeBox=function(){$("#code_editor").resizable({handles:"e, w"});$("#code_editor").resize(function(){$("#output_container").width($("#code_box_inner_container").width()-$("#code_editor").width()-20)});$(window).resize(function(){$("#output_container").width($("#code_box_inner_container").width()-$("#code_editor").width()-
20)})};$scope.resetCodeBoxDimensions=function(){$("#code_editor").css("width","50%");$("#output_container").width($("#code_box_inner_container").width()-$("#code_editor").width()-20)};$scope.selectedTab=function(tab){$rootScope.refreshCodeMirror();if(tab==="your_code");else if(tab==="solution")$("#solution *").attr("disabled","disabled");else;};$scope.changeTechnology=function(technology){$scope.currentTechnology=technology;console.log(technology);$scope.codeBoxPreferences.technology=JSON.stringify($scope.currentTechnology);
$rootScope.refreshCodeMirror();$scope.updateCodeBoxPreferencesInLocalStorage()};$scope.runCode=function(){console.log("compiler: "+$scope.currentTechnology.compiler);if($("#your_code_tab").hasClass("active")){console.log("run code");$rootScope.codeToCompile=$scope.data.sample_code;if($scope.data.solution!==null){console.log("solution present");$scope.showSolution=true}}if(angular.isDefined($scope.data.solution)&&$("#solution_tab").hasClass("active")){console.log("run solution");$rootScope.codeToCompile=
$scope.data.solution}console.log($rootScope.codeToCompile);var screen;if($rootScope.windowWidth<992){screen="mobile_screen_output";$scope.tabs[2].active=true}else screen="desktop_screen_output";var ifr=document.createElement("iframe");ifr.setAttribute("frameborder","0");ifr.setAttribute("id","iframeResult");ifr.setAttribute("name","iframeResult");if($scope.codeBoxOptions.isCodeChallenge)ifr.setAttribute("style","min-height:342px");else;console.log("screen: "+screen);if($scope.currentTechnology.compiler===
"html"){document.getElementById(screen).innerHTML="";document.getElementById(screen).appendChild(ifr);var ifrw=ifr.contentWindow?ifr.contentWindow:ifr.contentDocument.document?ifr.contentDocument.document:ifr.contentDocument;ifrw.document.open();ifrw.document.write($rootScope.codeToCompile);ifrw.document.close();$rootScope.enableNextButton()}else{$scope.formData={code:$rootScope.codeToCompile,compiler:$scope.currentTechnology.compiler};document.getElementById(screen).innerHTML=' <center><img style="margin-top:140px;" alt="loading" src="/static/images/spinner_blue.gif" ></center>';
$http({method:"POST",url:"/try_yourself/run_code",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){document.getElementById(screen).innerHTML="";document.getElementById(screen).appendChild(ifr);if($scope.currentTechnology.compiler==="php")ifr.src="https://codebox.internshala.com/webdev101/"+response.data;else{var ifrw=ifr.contentWindow?ifr.contentWindow:ifr.contentDocument.document?ifr.contentDocument.document:
ifr.contentDocument;ifrw.document.open();ifrw.document.write(response.data);ifrw.document.close()}$rootScope.enableNextButton()},function errorCallback(response){})}};$scope.resetCode=function(){console.log("reset");console.log($rootScope.defaultSampleCode);$scope.data.sample_code=angular.copy($rootScope.defaultSampleCode)};$scope.fullScreenCodeBox=function(){$("#code_box").addClass("fullscreen_code_box");var body=document.getElementsByTagName("BODY")[0];body.style.overflow="hidden";$(".CodeMirror").height($("#code_editor").height()-
92);if($rootScope.windowWidth>992)$(".output_screen").height($("#output_container").height()-44);$scope.resetCodeBoxDimensions();$rootScope.refreshCodeMirror()};$scope.closeFullScreenCodeBox=function(){$("#code_box").removeClass("fullscreen_code_box");var body=document.getElementsByTagName("BODY")[0];body.style.overflow="auto";$(".output_screen").height(0);if($scope.codeBoxOptions.isCodeChallenge){$(".CodeMirror").height(300);$("#iframeResult").height(342)}else{$(".output_screen").height($("#output_container").height()-
44);$(".CodeMirror").height($("#code_editor").height()-92)}$scope.resetCodeBoxDimensions();$rootScope.refreshCodeMirror()};$scope.changeTheme=function(){if($scope.codeBoxOptions.theme==="default"){$scope.codeBoxOptions.theme="monokai";$rootScope.codeMirrorOptions.theme="monokai";$scope.codeBoxPreferences.theme="monokai"}else{$scope.codeBoxOptions.theme="default";$rootScope.codeMirrorOptions.theme="default";$scope.codeBoxPreferences.theme="default"}$rootScope.refreshCodeMirror();$scope.updateCodeBoxPreferencesInLocalStorage()};
$scope.changeFontSize=function(size){$("#font_selector_dropdown.dropdown-menu li").removeClass("dropdown-menu-item-active");switch(size){case "huge":$(".CodeMirror").css("font-size","xx-large");$("#font_selector_dropdown.dropdown-menu li:nth-child(1)").addClass("dropdown-menu-item-active");break;case "large":$(".CodeMirror").css("font-size","large");$("#font_selector_dropdown.dropdown-menu li:nth-child(2)").addClass("dropdown-menu-item-active");break;case "normal":$(".CodeMirror").css("font-size",
"small");$("#font_selector_dropdown.dropdown-menu li:nth-child(3)").addClass("dropdown-menu-item-active");break;case "small":$(".CodeMirror").css("font-size","x-small");$("#font_selector_dropdown.dropdown-menu li:nth-child(4)").addClass("dropdown-menu-item-active");break}$scope.codeBoxPreferences.font=size;$scope.updateCodeBoxPreferencesInLocalStorage()};$scope.updateCodeBoxPreferencesInLocalStorage=function(){localStorage.setItem("codeBoxPref",JSON.stringify($scope.codeBoxPreferences))};$scope.applyLocalStoragePreferencesToCodeBox=
function(){$scope.changeFontSize($scope.codeBoxPreferences.font)}}]}}])})(angular);(function(ng){angular.module("tryYourself",[]).directive("tryYourself",[function(){return{restirct:"E",scope:{details:"="},replace:true,templateUrl:"/static/templates/content/try-yourself.html",controller:["$scope","$rootScope","$http","$sce","$timeout","$compile","helperFunctions",function($scope,$rootScope,$http,$sce,$timeout,$compile,helperFunctions){console.log("Try yourself");$scope.checkCodeMirrorAvailability=function(){console.log("a");if(typeof CodeMirror!=="undefined"){clearInterval($scope.availability);
$scope.getTechnologies()}};$scope.getTechnologies=function(){$scope.formData={course_url:$scope.details.course_url,compiler:$scope.details.compiler};$http({method:"POST",url:"/try_yourself/get_technologies",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:$.param($scope.formData)}).then(function successCallback(response){console.log(response);if(response.data.success){$scope.details.technologies=response.data.technologies;if(typeof response.data.technology==="undefined")$scope.details.technology=
response.data.technologies[0];else $scope.details.technology=response.data.technology;$rootScope.loadCodeBox()}else{helperFunctions.showAlertMessage("error","Invalid Url",function(){window.location="/"});return}},function errorCallback(response){})};$rootScope.loadCodeBox=function(){$scope.details.codeBoxOptions={showSolutionTab:false,showFullScreen:false,showSublimeThemeOption:true,showFontChooser:true,showTechnologies:true,isCodeChallenge:false,theme:"default",font:"normal"};$("#code_box").html($compile('<code-box data="details"></code-box>')($scope))};
if(typeof CodeMirror==="undefined"){console.log("no codemirror");$timeout(function(){postscribe("#head","<script src='/node_modules/codemirror/lib/codemirror.js'>\x3c/script>");postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/lib/codemirror.css'>");postscribe("#head","<script src='/node_modules/codemirror/mode/htmlmixed/htmlmixed.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/php/php.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/css/css.js'>\x3c/script>");
postscribe("#head","<script src='/node_modules/codemirror/mode/javascript/javascript.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/xml/xml.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/mode/clike/clike.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/selection/active-line.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/edit/closetag.js'>\x3c/script>");postscribe("#head",
"<script src='/node_modules/codemirror/addon/edit/closebrackets.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/display/fullscreen.js'>\x3c/script>");postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/addon/display/fullscreen.css'>");postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/theme/monokai.css'>");postscribe("#head","<script src='/node_modules/codemirror/addon/lint/lint.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/lint/css-lint.js'>\x3c/script>");
postscribe("#head","<script src='/node_modules/codemirror/addon/lint/html-lint.js'>\x3c/script>");postscribe("#head","<script src='/node_modules/codemirror/addon/lint/javascript-lint.js'>\x3c/script>");postscribe("#head","<script src='//ajax.aspnetcdn.com/ajax/jshint/r07/jshint.js'>\x3c/script>");postscribe("#head","<link rel='stylesheet' href='/node_modules/codemirror/addon/lint/lint.css'>")},1E3);$scope.availability=setInterval($scope.checkCodeMirrorAvailability,500)}else{console.log("codemirror present");
$rootScope.loadCodeBox()}}]}}])})(angular);
